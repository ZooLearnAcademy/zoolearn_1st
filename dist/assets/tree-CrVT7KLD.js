import{a as e,b as t,c as n,d as r,f as i,h as a,i as o,l as s,m as c,n as l,o as u,p as d,r as f,s as p,t as m,u as h,v as g,x as _,y as v}from"./index-lr2dLpbK.js";function y(e,t){t||=[];var n=e?Math.min(t.length,e.length):0,r=t.slice(),i;return function(a){for(i=0;i<n;++i)r[i]=e[i]*(1-a)+t[i]*a;return r}}function b(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function x(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,i=Array(r),a=Array(n),o;for(o=0;o<r;++o)i[o]=w(e[o],t[o]);for(;o<n;++o)a[o]=t[o];return function(e){for(o=0;o<r;++o)a[o]=i[o](e);return a}}function S(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function C(e,t){var n={},r={},i;for(i in(typeof e!=`object`||!e)&&(e={}),(typeof t!=`object`||!t)&&(t={}),t)i in e?n[i]=w(e[i],t[i]):r[i]=t[i];return function(e){for(i in n)r[i]=n[i](e);return r}}function w(t,r){var i=typeof r,a;return r==null||i===`boolean`?n(r):(i===`number`?u:i===`string`?(a=s(r))?(r=a,p):e:r instanceof s?p:r instanceof Date?S:b(r)?y:Array.isArray(r)?x:typeof r.valueOf!=`function`&&typeof r.toString!=`function`||isNaN(r)?C:u)(t,r)}var T=a(),E=_(t(),1),D={error001:()=>`[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001`,error002:()=>`It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.`,error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>`The React Flow parent container needs a width and a height to render the graph.`,error005:()=>`Only child nodes can use a parent extent.`,error006:()=>`Can't create edge. An edge needs a source and a target.`,error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,{id:t,sourceHandle:n,targetHandle:r})=>`Couldn't create edge for ${e} handle id: "${e===`source`?n:r}", edge id: ${t}.`,error010:()=>`Handle: No node id found. Make sure to only use a Handle inside a custom Node.`,error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(e=`react`)=>`It seems that you haven't loaded the styles. Please import '@xyflow/${e}/dist/style.css' or base.css to make sure everything is working properly.`,error014:()=>`useNodeConnections: No node ID found. Call useNodeConnections inside a custom Node or provide a node ID.`,error015:()=>`It seems that you are trying to drag a node that is not initialized. Please use onNodesChange as explained in the docs.`},O=[[-1/0,-1/0],[1/0,1/0]],k=[`Enter`,` `,`Escape`],A={"node.a11yDescription.default":`Press enter or space to select a node. Press delete to remove it and escape to cancel.`,"node.a11yDescription.keyboardDisabled":`Press enter or space to select a node. You can then use the arrow keys to move the node around. Press delete to remove it and escape to cancel.`,"node.a11yDescription.ariaLiveMessage":({direction:e,x:t,y:n})=>`Moved selected node ${e}. New position, x: ${t}, y: ${n}`,"edge.a11yDescription.default":`Press enter or space to select an edge. You can then press delete to remove it or escape to cancel.`,"controls.ariaLabel":`Control Panel`,"controls.zoomIn.ariaLabel":`Zoom In`,"controls.zoomOut.ariaLabel":`Zoom Out`,"controls.fitView.ariaLabel":`Fit View`,"controls.interactive.ariaLabel":`Toggle Interactivity`,"minimap.ariaLabel":`Mini Map`,"handle.ariaLabel":`Handle`},j;(function(e){e.Strict=`strict`,e.Loose=`loose`})(j||={});var M;(function(e){e.Free=`free`,e.Vertical=`vertical`,e.Horizontal=`horizontal`})(M||={});var N;(function(e){e.Partial=`partial`,e.Full=`full`})(N||={});var P={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null,pointer:null},F;(function(e){e.Bezier=`default`,e.Straight=`straight`,e.Step=`step`,e.SmoothStep=`smoothstep`,e.SimpleBezier=`simplebezier`})(F||={});var I;(function(e){e.Arrow=`arrow`,e.ArrowClosed=`arrowclosed`})(I||={});var L;(function(e){e.Left=`left`,e.Top=`top`,e.Right=`right`,e.Bottom=`bottom`})(L||={});var R={[L.Left]:L.Right,[L.Right]:L.Left,[L.Top]:L.Bottom,[L.Bottom]:L.Top};function z(e){return e===null?null:e?`valid`:`invalid`}var B=e=>`id`in e&&`source`in e&&`target`in e,V=e=>`id`in e&&`position`in e&&!(`source`in e)&&!(`target`in e),H=e=>`id`in e&&`internals`in e&&!(`source`in e)&&!(`target`in e),U=(e,t=[0,0])=>{let{width:n,height:r}=Ee(e),i=e.origin??t,a=n*i[0],o=r*i[1];return{x:e.position.x-a,y:e.position.y-o}},W=(e,t={nodeOrigin:[0,0]})=>e.length===0?{x:0,y:0,width:0,height:0}:de(e.reduce((e,n)=>{let r=typeof n==`string`,i=!t.nodeLookup&&!r?n:void 0;return t.nodeLookup&&(i=r?t.nodeLookup.get(n):H(n)?n:t.nodeLookup.get(n.id)),le(e,i?fe(i,t.nodeOrigin):{x:0,y:0,x2:0,y2:0})},{x:1/0,y:1/0,x2:-1/0,y2:-1/0})),G=(e,t={})=>{let n={x:1/0,y:1/0,x2:-1/0,y2:-1/0},r=!1;return e.forEach(e=>{(t.filter===void 0||t.filter(e))&&(n=le(n,fe(e)),r=!0)}),r?de(n):{x:0,y:0,width:0,height:0}},K=(e,t,[n,r,i]=[0,0,1],a=!1,o=!1)=>{let s={...ve(t,[n,r,i]),width:t.width/i,height:t.height/i},c=[];for(let t of e.values()){let{measured:e,selectable:n=!0,hidden:r=!1}=t;if(o&&!n||r)continue;let i=e.width??t.width??t.initialWidth??null,l=e.height??t.height??t.initialHeight??null,u=me(s,J(t)),d=(i??0)*(l??0),f=a&&u>0;(!t.internals.handleBounds||f||u>=d||t.dragging)&&c.push(t)}return c},q=(e,t)=>{let n=new Set;return e.forEach(e=>{n.add(e.id)}),t.filter(e=>n.has(e.source)||n.has(e.target))};function ee(e,t){let n=new Map,r=t?.nodes?new Set(t.nodes.map(e=>e.id)):null;return e.forEach(e=>{e.measured.width&&e.measured.height&&(t?.includeHiddenNodes||!e.hidden)&&(!r||r.has(e.id))&&n.set(e.id,e)}),n}async function te({nodes:e,width:t,height:n,panZoom:r,minZoom:i,maxZoom:a},o){if(e.size===0)return Promise.resolve(!0);let s=Ce(G(ee(e,o)),t,n,o?.minZoom??i,o?.maxZoom??a,o?.padding??.1);return await r.setViewport(s,{duration:o?.duration,ease:o?.ease,interpolate:o?.interpolate}),Promise.resolve(!0)}function ne({nodeId:e,nextPosition:t,nodeLookup:n,nodeOrigin:r=[0,0],nodeExtent:i,onError:a}){let o=n.get(e),s=o.parentId?n.get(o.parentId):void 0,{x:c,y:l}=s?s.internals.positionAbsolute:{x:0,y:0},u=o.origin??r,d=o.extent||i;if(o.extent===`parent`&&!o.expandParent)if(!s)a?.(`005`,D.error005());else{let e=s.measured.width,t=s.measured.height;e&&t&&(d=[[c,l],[c+e,l+t]])}else s&&Te(o.extent)&&(d=[[o.extent[0][0]+c,o.extent[0][1]+l],[o.extent[1][0]+c,o.extent[1][1]+l]]);let f=Te(d)?ae(t,d,o.measured):t;return(o.measured.width===void 0||o.measured.height===void 0)&&a?.(`015`,D.error015()),{position:{x:f.x-c+(o.measured.width??0)*u[0],y:f.y-l+(o.measured.height??0)*u[1]},positionAbsolute:f}}async function re({nodesToRemove:e=[],edgesToRemove:t=[],nodes:n,edges:r,onBeforeDelete:i}){let a=new Set(e.map(e=>e.id)),o=[];for(let e of n){if(e.deletable===!1)continue;let t=a.has(e.id),n=!t&&e.parentId&&o.find(t=>t.id===e.parentId);(t||n)&&o.push(e)}let s=new Set(t.map(e=>e.id)),c=r.filter(e=>e.deletable!==!1),l=q(o,c);for(let e of c)s.has(e.id)&&!l.find(t=>t.id===e.id)&&l.push(e);if(!i)return{edges:l,nodes:o};let u=await i({nodes:o,edges:l});return typeof u==`boolean`?u?{edges:l,nodes:o}:{edges:[],nodes:[]}:u}var ie=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),ae=(e={x:0,y:0},t,n)=>({x:ie(e.x,t[0][0],t[1][0]-(n?.width??0)),y:ie(e.y,t[0][1],t[1][1]-(n?.height??0))});function oe(e,t,n){let{width:r,height:i}=Ee(n),{x:a,y:o}=n.internals.positionAbsolute;return ae(e,[[a,o],[a+r,o+i]],t)}var se=(e,t,n)=>e<t?ie(Math.abs(e-t),1,t)/t:e>n?-ie(Math.abs(e-n),1,t)/t:0,ce=(e,t,n=15,r=40)=>[se(e.x,r,t.width-r)*n,se(e.y,r,t.height-r)*n],le=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),ue=({x:e,y:t,width:n,height:r})=>({x:e,y:t,x2:e+n,y2:t+r}),de=({x:e,y:t,x2:n,y2:r})=>({x:e,y:t,width:n-e,height:r-t}),J=(e,t=[0,0])=>{let{x:n,y:r}=H(e)?e.internals.positionAbsolute:U(e,t);return{x:n,y:r,width:e.measured?.width??e.width??e.initialWidth??0,height:e.measured?.height??e.height??e.initialHeight??0}},fe=(e,t=[0,0])=>{let{x:n,y:r}=H(e)?e.internals.positionAbsolute:U(e,t);return{x:n,y:r,x2:n+(e.measured?.width??e.width??e.initialWidth??0),y2:r+(e.measured?.height??e.height??e.initialHeight??0)}},pe=(e,t)=>de(le(ue(e),ue(t))),me=(e,t)=>{let n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),r=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*r)},he=e=>Y(e.width)&&Y(e.height)&&Y(e.x)&&Y(e.y),Y=e=>!isNaN(e)&&isFinite(e),ge=(e,t)=>{},_e=(e,t=[1,1])=>({x:t[0]*Math.round(e.x/t[0]),y:t[1]*Math.round(e.y/t[1])}),ve=({x:e,y:t},[n,r,i],a=!1,o=[1,1])=>{let s={x:(e-n)/i,y:(t-r)/i};return a?_e(s,o):s},ye=({x:e,y:t},[n,r,i])=>({x:e*i+n,y:t*i+r});function be(e,t){if(typeof e==`number`)return Math.floor((t-t/(1+e))*.5);if(typeof e==`string`&&e.endsWith(`px`)){let t=parseFloat(e);if(!Number.isNaN(t))return Math.floor(t)}if(typeof e==`string`&&e.endsWith(`%`)){let n=parseFloat(e);if(!Number.isNaN(n))return Math.floor(t*n*.01)}return console.error(`[React Flow] The padding value "${e}" is invalid. Please provide a number or a string with a valid unit (px or %).`),0}function xe(e,t,n){if(typeof e==`string`||typeof e==`number`){let r=be(e,n),i=be(e,t);return{top:r,right:i,bottom:r,left:i,x:i*2,y:r*2}}if(typeof e==`object`){let r=be(e.top??e.y??0,n),i=be(e.bottom??e.y??0,n),a=be(e.left??e.x??0,t),o=be(e.right??e.x??0,t);return{top:r,right:o,bottom:i,left:a,x:a+o,y:r+i}}return{top:0,right:0,bottom:0,left:0,x:0,y:0}}function Se(e,t,n,r,i,a){let{x:o,y:s}=ye(e,[t,n,r]),{x:c,y:l}=ye({x:e.x+e.width,y:e.y+e.height},[t,n,r]),u=i-c,d=a-l;return{left:Math.floor(o),top:Math.floor(s),right:Math.floor(u),bottom:Math.floor(d)}}var Ce=(e,t,n,r,i,a)=>{let o=xe(a,t,n),s=(t-o.x)/e.width,c=(n-o.y)/e.height,l=ie(Math.min(s,c),r,i),u=e.x+e.width/2,d=e.y+e.height/2,f=t/2-u*l,p=n/2-d*l,m=Se(e,f,p,l,t,n),h={left:Math.min(m.left-o.left,0),top:Math.min(m.top-o.top,0),right:Math.min(m.right-o.right,0),bottom:Math.min(m.bottom-o.bottom,0)};return{x:f-h.left+h.right,y:p-h.top+h.bottom,zoom:l}},we=()=>typeof navigator<`u`&&navigator?.userAgent?.indexOf(`Mac`)>=0;function Te(e){return e!=null&&e!==`parent`}function Ee(e){return{width:e.measured?.width??e.width??e.initialWidth??0,height:e.measured?.height??e.height??e.initialHeight??0}}function De(e){return(e.measured?.width??e.width??e.initialWidth)!==void 0&&(e.measured?.height??e.height??e.initialHeight)!==void 0}function Oe(e,t={width:0,height:0},n,r,i){let a={...e},o=r.get(n);if(o){let e=o.origin||i;a.x+=o.internals.positionAbsolute.x-(t.width??0)*e[0],a.y+=o.internals.positionAbsolute.y-(t.height??0)*e[1]}return a}function ke(e,t){if(e.size!==t.size)return!1;for(let n of e)if(!t.has(n))return!1;return!0}function Ae(){let e,t;return{promise:new Promise((n,r)=>{e=n,t=r}),resolve:e,reject:t}}function je(e){return{...A,...e||{}}}function Me(e,{snapGrid:t=[0,0],snapToGrid:n=!1,transform:r,containerBounds:i}){let{x:a,y:o}=X(e),s=ve({x:a-(i?.left??0),y:o-(i?.top??0)},r),{x:c,y:l}=n?_e(s,t):s;return{xSnapped:c,ySnapped:l,...s}}var Ne=e=>({width:e.offsetWidth,height:e.offsetHeight}),Pe=e=>e?.getRootNode?.()||window?.document,Fe=[`INPUT`,`SELECT`,`TEXTAREA`];function Ie(e){let t=e.composedPath?.()?.[0]||e.target;return t?.nodeType===1?Fe.includes(t.nodeName)||t.hasAttribute(`contenteditable`)||!!t.closest(`.nokey`):!1}var Le=e=>`clientX`in e,X=(e,t)=>{let n=Le(e),r=n?e.clientX:e.touches?.[0].clientX,i=n?e.clientY:e.touches?.[0].clientY;return{x:r-(t?.left??0),y:i-(t?.top??0)}},Re=(e,t,n,r,i)=>{let a=t.querySelectorAll(`.${e}`);return!a||!a.length?null:Array.from(a).map(t=>{let a=t.getBoundingClientRect();return{id:t.getAttribute(`data-handleid`),type:e,nodeId:i,position:t.getAttribute(`data-handlepos`),x:(a.left-n.left)/r,y:(a.top-n.top)/r,...Ne(t)}})};function ze({sourceX:e,sourceY:t,targetX:n,targetY:r,sourceControlX:i,sourceControlY:a,targetControlX:o,targetControlY:s}){let c=e*.125+i*.375+o*.375+n*.125,l=t*.125+a*.375+s*.375+r*.125;return[c,l,Math.abs(c-e),Math.abs(l-t)]}function Be(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function Ve({pos:e,x1:t,y1:n,x2:r,y2:i,c:a}){switch(e){case L.Left:return[t-Be(t-r,a),n];case L.Right:return[t+Be(r-t,a),n];case L.Top:return[t,n-Be(n-i,a)];case L.Bottom:return[t,n+Be(i-n,a)]}}function He({sourceX:e,sourceY:t,sourcePosition:n=L.Bottom,targetX:r,targetY:i,targetPosition:a=L.Top,curvature:o=.25}){let[s,c]=Ve({pos:n,x1:e,y1:t,x2:r,y2:i,c:o}),[l,u]=Ve({pos:a,x1:r,y1:i,x2:e,y2:t,c:o}),[d,f,p,m]=ze({sourceX:e,sourceY:t,targetX:r,targetY:i,sourceControlX:s,sourceControlY:c,targetControlX:l,targetControlY:u});return[`M${e},${t} C${s},${c} ${l},${u} ${r},${i}`,d,f,p,m]}function Ue({sourceX:e,sourceY:t,targetX:n,targetY:r}){let i=Math.abs(n-e)/2,a=n<e?n+i:n-i,o=Math.abs(r-t)/2;return[a,r<t?r+o:r-o,i,o]}function We({sourceNode:e,targetNode:t,selected:n=!1,zIndex:r=0,elevateOnSelect:i=!1,zIndexMode:a=`basic`}){return a===`manual`?r:(i&&n?r+1e3:r)+Math.max(e.parentId||i&&e.selected?e.internals.z:0,t.parentId||i&&t.selected?t.internals.z:0)}function Ge({sourceNode:e,targetNode:t,width:n,height:r,transform:i}){let a=le(fe(e),fe(t));return a.x===a.x2&&(a.x2+=1),a.y===a.y2&&(a.y2+=1),me({x:-i[0]/i[2],y:-i[1]/i[2],width:n/i[2],height:r/i[2]},de(a))>0}var Ke=({source:e,sourceHandle:t,target:n,targetHandle:r})=>`xy-edge__${e}${t||``}-${n}${r||``}`,qe=(e,t)=>t.some(t=>t.source===e.source&&t.target===e.target&&(t.sourceHandle===e.sourceHandle||!t.sourceHandle&&!e.sourceHandle)&&(t.targetHandle===e.targetHandle||!t.targetHandle&&!e.targetHandle)),Je=(e,t,n={})=>{if(!e.source||!e.target)return D.error006(),t;let r=n.getEdgeId||Ke,i;return i=B(e)?{...e}:{...e,id:r(e)},qe(i,t)?t:(i.sourceHandle===null&&delete i.sourceHandle,i.targetHandle===null&&delete i.targetHandle,t.concat(i))};function Ye({sourceX:e,sourceY:t,targetX:n,targetY:r}){let[i,a,o,s]=Ue({sourceX:e,sourceY:t,targetX:n,targetY:r});return[`M ${e},${t}L ${n},${r}`,i,a,o,s]}var Xe={[L.Left]:{x:-1,y:0},[L.Right]:{x:1,y:0},[L.Top]:{x:0,y:-1},[L.Bottom]:{x:0,y:1}},Ze=({source:e,sourcePosition:t=L.Bottom,target:n})=>t===L.Left||t===L.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},Qe=(e,t)=>Math.sqrt((t.x-e.x)**2+(t.y-e.y)**2);function $e({source:e,sourcePosition:t=L.Bottom,target:n,targetPosition:r=L.Top,center:i,offset:a,stepPosition:o}){let s=Xe[t],c=Xe[r],l={x:e.x+s.x*a,y:e.y+s.y*a},u={x:n.x+c.x*a,y:n.y+c.y*a},d=Ze({source:l,sourcePosition:t,target:u}),f=d.x===0?`y`:`x`,p=d[f],m=[],h,g,_={x:0,y:0},v={x:0,y:0},[,,y,b]=Ue({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(s[f]*c[f]===-1){f===`x`?(h=i.x??l.x+(u.x-l.x)*o,g=i.y??(l.y+u.y)/2):(h=i.x??(l.x+u.x)/2,g=i.y??l.y+(u.y-l.y)*o);let e=[{x:h,y:l.y},{x:h,y:u.y}],t=[{x:l.x,y:g},{x:u.x,y:g}];m=s[f]===p?f===`x`?e:t:f===`x`?t:e}else{let i=[{x:l.x,y:u.y}],o=[{x:u.x,y:l.y}];if(m=f===`x`?s.x===p?o:i:s.y===p?i:o,t===r){let t=Math.abs(e[f]-n[f]);if(t<=a){let r=Math.min(a-1,a-t);s[f]===p?_[f]=(l[f]>e[f]?-1:1)*r:v[f]=(u[f]>n[f]?-1:1)*r}}if(t!==r){let e=f===`x`?`y`:`x`,t=s[f]===c[e],n=l[e]>u[e],r=l[e]<u[e];(s[f]===1&&(!t&&n||t&&r)||s[f]!==1&&(!t&&r||t&&n))&&(m=f===`x`?i:o)}let d={x:l.x+_.x,y:l.y+_.y},y={x:u.x+v.x,y:u.y+v.y};Math.max(Math.abs(d.x-m[0].x),Math.abs(y.x-m[0].x))>=Math.max(Math.abs(d.y-m[0].y),Math.abs(y.y-m[0].y))?(h=(d.x+y.x)/2,g=m[0].y):(h=m[0].x,g=(d.y+y.y)/2)}return[[e,{x:l.x+_.x,y:l.y+_.y},...m,{x:u.x+v.x,y:u.y+v.y},n],h,g,y,b]}function et(e,t,n,r){let i=Math.min(Qe(e,t)/2,Qe(t,n)/2,r),{x:a,y:o}=t;if(e.x===a&&a===n.x||e.y===o&&o===n.y)return`L${a} ${o}`;if(e.y===o){let t=e.x<n.x?-1:1,r=e.y<n.y?1:-1;return`L ${a+i*t},${o}Q ${a},${o} ${a},${o+i*r}`}let s=e.x<n.x?1:-1;return`L ${a},${o+i*(e.y<n.y?-1:1)}Q ${a},${o} ${a+i*s},${o}`}function tt({sourceX:e,sourceY:t,sourcePosition:n=L.Bottom,targetX:r,targetY:i,targetPosition:a=L.Top,borderRadius:o=5,centerX:s,centerY:c,offset:l=20,stepPosition:u=.5}){let[d,f,p,m,h]=$e({source:{x:e,y:t},sourcePosition:n,target:{x:r,y:i},targetPosition:a,center:{x:s,y:c},offset:l,stepPosition:u});return[d.reduce((e,t,n)=>{let r=``;return r=n>0&&n<d.length-1?et(d[n-1],t,d[n+1],o):`${n===0?`M`:`L`}${t.x} ${t.y}`,e+=r,e},``),f,p,m,h]}function nt(e){return e&&!!(e.internals.handleBounds||e.handles?.length)&&!!(e.measured.width||e.width||e.initialWidth)}function rt(e){let{sourceNode:t,targetNode:n}=e;if(!nt(t)||!nt(n))return null;let r=t.internals.handleBounds||it(t.handles),i=n.internals.handleBounds||it(n.handles),a=ot(r?.source??[],e.sourceHandle),o=ot(e.connectionMode===j.Strict?i?.target??[]:(i?.target??[]).concat(i?.source??[]),e.targetHandle);if(!a||!o)return e.onError?.(`008`,D.error008(a?`target`:`source`,{id:e.id,sourceHandle:e.sourceHandle,targetHandle:e.targetHandle})),null;let s=a?.position||L.Bottom,c=o?.position||L.Top,l=at(t,a,s),u=at(n,o,c);return{sourceX:l.x,sourceY:l.y,targetX:u.x,targetY:u.y,sourcePosition:s,targetPosition:c}}function it(e){if(!e)return null;let t=[],n=[];for(let r of e)r.width=r.width??1,r.height=r.height??1,r.type===`source`?t.push(r):r.type===`target`&&n.push(r);return{source:t,target:n}}function at(e,t,n=L.Left,r=!1){let i=(t?.x??0)+e.internals.positionAbsolute.x,a=(t?.y??0)+e.internals.positionAbsolute.y,{width:o,height:s}=t??Ee(e);if(r)return{x:i+o/2,y:a+s/2};switch(t?.position??n){case L.Top:return{x:i+o/2,y:a};case L.Right:return{x:i+o,y:a+s/2};case L.Bottom:return{x:i+o/2,y:a+s};case L.Left:return{x:i,y:a+s/2}}}function ot(e,t){return e&&(t?e.find(e=>e.id===t):e[0])||null}function st(e,t){return e?typeof e==`string`?e:`${t?`${t}__`:``}${Object.keys(e).sort().map(t=>`${t}=${e[t]}`).join(`&`)}`:``}function ct(e,{id:t,defaultColor:n,defaultMarkerStart:r,defaultMarkerEnd:i}){let a=new Set;return e.reduce((e,o)=>([o.markerStart||r,o.markerEnd||i].forEach(r=>{if(r&&typeof r==`object`){let i=st(r,t);a.has(i)||(e.push({id:i,color:r.color||n,...r}),a.add(i))}}),e),[]).sort((e,t)=>e.id.localeCompare(t.id))}var lt=1e3,ut=10,dt={nodeOrigin:[0,0],nodeExtent:O,elevateNodesOnSelect:!0,zIndexMode:`basic`,defaults:{}},ft={...dt,checkEquality:!0};function pt(e,t){let n={...e};for(let e in t)t[e]!==void 0&&(n[e]=t[e]);return n}function mt(e,t,n){let r=pt(dt,n);for(let n of e.values())if(n.parentId)yt(n,e,t,r);else{let e=ae(U(n,r.nodeOrigin),Te(n.extent)?n.extent:r.nodeExtent,Ee(n));n.internals.positionAbsolute=e}}function ht(e,t){if(!e.handles)return e.measured?t?.internals.handleBounds:void 0;let n=[],r=[];for(let t of e.handles){let i={id:t.id,width:t.width??1,height:t.height??1,nodeId:e.id,x:t.x,y:t.y,position:t.position,type:t.type};t.type===`source`?n.push(i):t.type===`target`&&r.push(i)}return{source:n,target:r}}function gt(e){return e===`manual`}function _t(e,t,n,r={}){let i=pt(ft,r),a={i:0},o=new Map(t),s=i?.elevateNodesOnSelect&&!gt(i.zIndexMode)?lt:0,c=e.length>0;t.clear(),n.clear();for(let l of e){let e=o.get(l.id);if(i.checkEquality&&l===e?.internals.userNode)t.set(l.id,e);else{let n=ae(U(l,i.nodeOrigin),Te(l.extent)?l.extent:i.nodeExtent,Ee(l));e={...i.defaults,...l,measured:{width:l.measured?.width,height:l.measured?.height},internals:{positionAbsolute:n,handleBounds:ht(l,e),z:bt(l,s,i.zIndexMode),userNode:l}},t.set(l.id,e)}(e.measured===void 0||e.measured.width===void 0||e.measured.height===void 0)&&!e.hidden&&(c=!1),l.parentId&&yt(e,t,n,r,a)}return c}function vt(e,t){if(!e.parentId)return;let n=t.get(e.parentId);n?n.set(e.id,e):t.set(e.parentId,new Map([[e.id,e]]))}function yt(e,t,n,r,i){let{elevateNodesOnSelect:a,nodeOrigin:o,nodeExtent:s,zIndexMode:c}=pt(dt,r),l=e.parentId,u=t.get(l);if(!u){console.warn(`Parent node ${l} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);return}vt(e,n),i&&!u.parentId&&u.internals.rootParentIndex===void 0&&c===`auto`&&(u.internals.rootParentIndex=++i.i,u.internals.z=u.internals.z+i.i*ut),i&&u.internals.rootParentIndex!==void 0&&(i.i=u.internals.rootParentIndex);let{x:d,y:f,z:p}=xt(e,u,o,s,a&&!gt(c)?lt:0,c),{positionAbsolute:m}=e.internals,h=d!==m.x||f!==m.y;(h||p!==e.internals.z)&&t.set(e.id,{...e,internals:{...e.internals,positionAbsolute:h?{x:d,y:f}:m,z:p}})}function bt(e,t,n){let r=Y(e.zIndex)?e.zIndex:0;return gt(n)?r:r+(e.selected?t:0)}function xt(e,t,n,r,i,a){let{x:o,y:s}=t.internals.positionAbsolute,c=Ee(e),l=U(e,n),u=Te(e.extent)?ae(l,e.extent,c):l,d=ae({x:o+u.x,y:s+u.y},r,c);e.extent===`parent`&&(d=oe(d,c,t));let f=bt(e,i,a),p=t.internals.z??0;return{x:d.x,y:d.y,z:p>=f?p+1:f}}function St(e,t,n,r=[0,0]){let i=[],a=new Map;for(let n of e){let e=t.get(n.parentId);if(!e)continue;let r=pe(a.get(n.parentId)?.expandedRect??J(e),n.rect);a.set(n.parentId,{expandedRect:r,parent:e})}return a.size>0&&a.forEach(({expandedRect:t,parent:a},o)=>{let s=a.internals.positionAbsolute,c=Ee(a),l=a.origin??r,u=t.x<s.x?Math.round(Math.abs(s.x-t.x)):0,d=t.y<s.y?Math.round(Math.abs(s.y-t.y)):0,f=Math.max(c.width,Math.round(t.width)),p=Math.max(c.height,Math.round(t.height)),m=(f-c.width)*l[0],h=(p-c.height)*l[1];(u>0||d>0||m||h)&&(i.push({id:o,type:`position`,position:{x:a.position.x-u+m,y:a.position.y-d+h}}),n.get(o)?.forEach(t=>{e.some(e=>e.id===t.id)||i.push({id:t.id,type:`position`,position:{x:t.position.x+u,y:t.position.y+d}})})),(c.width<t.width||c.height<t.height||u||d)&&i.push({id:o,type:`dimensions`,setAttributes:!0,dimensions:{width:f+(u?l[0]*u-m:0),height:p+(d?l[1]*d-h:0)}})}),i}function Ct(e,t,n,r,i,a,o){let s=r?.querySelector(`.xyflow__viewport`),c=!1;if(!s)return{changes:[],updatedInternals:c};let l=[],u=window.getComputedStyle(s),{m22:d}=new window.DOMMatrixReadOnly(u.transform),f=[];for(let r of e.values()){let e=t.get(r.id);if(!e)continue;if(e.hidden){t.set(e.id,{...e,internals:{...e.internals,handleBounds:void 0}}),c=!0;continue}let s=Ne(r.nodeElement),u=e.measured.width!==s.width||e.measured.height!==s.height;if(s.width&&s.height&&(u||!e.internals.handleBounds||r.force)){let p=r.nodeElement.getBoundingClientRect(),m=Te(e.extent)?e.extent:a,{positionAbsolute:h}=e.internals;e.parentId&&e.extent===`parent`?h=oe(h,s,t.get(e.parentId)):m&&(h=ae(h,m,s));let g={...e,measured:s,internals:{...e.internals,positionAbsolute:h,handleBounds:{source:Re(`source`,r.nodeElement,p,d,e.id),target:Re(`target`,r.nodeElement,p,d,e.id)}}};t.set(e.id,g),e.parentId&&yt(g,t,n,{nodeOrigin:i,zIndexMode:o}),c=!0,u&&(l.push({id:e.id,type:`dimensions`,dimensions:s}),e.expandParent&&e.parentId&&f.push({id:e.id,parentId:e.parentId,rect:J(g,i)}))}}if(f.length>0){let e=St(f,t,n,i);l.push(...e)}return{changes:l,updatedInternals:c}}async function wt({delta:e,panZoom:t,transform:n,translateExtent:r,width:i,height:a}){if(!t||!e.x&&!e.y)return Promise.resolve(!1);let o=await t.setViewportConstrained({x:n[0]+e.x,y:n[1]+e.y,zoom:n[2]},[[0,0],[i,a]],r),s=!!o&&(o.x!==n[0]||o.y!==n[1]||o.k!==n[2]);return Promise.resolve(s)}function Tt(e,t,n,r,i,a){let o=i,s=r.get(o)||new Map;r.set(o,s.set(n,t)),o=`${i}-${e}`;let c=r.get(o)||new Map;if(r.set(o,c.set(n,t)),a){o=`${i}-${e}-${a}`;let s=r.get(o)||new Map;r.set(o,s.set(n,t))}}function Et(e,t,n){e.clear(),t.clear();for(let r of n){let{source:n,target:i,sourceHandle:a=null,targetHandle:o=null}=r,s={edgeId:r.id,source:n,target:i,sourceHandle:a,targetHandle:o},c=`${n}-${a}--${i}-${o}`;Tt(`source`,s,`${i}-${o}--${n}-${a}`,e,n,a),Tt(`target`,s,c,e,i,o),t.set(r.id,r)}}function Dt(e,t){if(!e.parentId)return!1;let n=t.get(e.parentId);return n?n.selected?!0:Dt(n,t):!1}function Ot(e,t,n){let r=e;do{if(r?.matches?.(t))return!0;if(r===n)return!1;r=r?.parentElement}while(r);return!1}function kt(e,t,n,r){let i=new Map;for(let[a,o]of e)if((o.selected||o.id===r)&&(!o.parentId||!Dt(o,e))&&(o.draggable||t&&o.draggable===void 0)){let t=e.get(a);t&&i.set(a,{id:a,position:t.position||{x:0,y:0},distance:{x:n.x-t.internals.positionAbsolute.x,y:n.y-t.internals.positionAbsolute.y},extent:t.extent,parentId:t.parentId,origin:t.origin,expandParent:t.expandParent,internals:{positionAbsolute:t.internals.positionAbsolute||{x:0,y:0}},measured:{width:t.measured.width??0,height:t.measured.height??0}})}return i}function At({nodeId:e,dragItems:t,nodeLookup:n,dragging:r=!0}){let i=[];for(let[e,a]of t){let t=n.get(e)?.internals.userNode;t&&i.push({...t,position:a.position,dragging:r})}if(!e)return[i[0],i];let a=n.get(e)?.internals.userNode;return[a?{...a,position:t.get(e)?.position||a.position,dragging:r}:i[0],i]}function jt({dragItems:e,snapGrid:t,x:n,y:r}){let i=e.values().next().value;if(!i)return null;let a={x:n-i.distance.x,y:r-i.distance.y},o=_e(a,t);return{x:o.x-a.x,y:o.y-a.y}}function Mt({onNodeMouseDown:e,getStoreItems:t,onDragStart:n,onDrag:r,onDragStop:a}){let o={x:null,y:null},s=0,c=new Map,l=!1,u={x:0,y:0},d=null,f=!1,p=null,m=!1,g=!1,_=null;function v({noDragClassName:v,handleSelector:y,domNode:b,isSelectable:x,nodeId:S,nodeClickDistance:C=0}){p=i(b);function w({x:e,y:n}){let{nodeLookup:i,nodeExtent:a,snapGrid:s,snapToGrid:l,nodeOrigin:u,onNodeDrag:d,onSelectionDrag:f,onError:p,updateNodePositions:m}=t();o={x:e,y:n};let h=!1,v=c.size>1,y=v&&a?ue(G(c)):null,b=v&&l?jt({dragItems:c,snapGrid:s,x:e,y:n}):null;for(let[t,r]of c){if(!i.has(t))continue;let o={x:e-r.distance.x,y:n-r.distance.y};l&&(o=b?{x:Math.round(o.x+b.x),y:Math.round(o.y+b.y)}:_e(o,s));let c=null;if(v&&a&&!r.extent&&y){let{positionAbsolute:e}=r.internals,t=e.x-y.x+a[0][0],n=e.x+r.measured.width-y.x2+a[1][0],i=e.y-y.y+a[0][1],o=e.y+r.measured.height-y.y2+a[1][1];c=[[t,i],[n,o]]}let{position:d,positionAbsolute:f}=ne({nodeId:t,nextPosition:o,nodeLookup:i,nodeExtent:c||a,nodeOrigin:u,onError:p});h=h||r.position.x!==d.x||r.position.y!==d.y,r.position=d,r.internals.positionAbsolute=f}if(g||=h,h&&(m(c,!0),_&&(r||d||!S&&f))){let[e,t]=At({nodeId:S,dragItems:c,nodeLookup:i});r?.(_,c,e,t),d?.(_,e,t),S||f?.(_,t)}}async function T(){if(!d)return;let{transform:e,panBy:n,autoPanSpeed:r,autoPanOnNodeDrag:i}=t();if(!i){l=!1,cancelAnimationFrame(s);return}let[a,c]=ce(u,d,r);(a!==0||c!==0)&&(o.x=(o.x??0)-a/e[2],o.y=(o.y??0)-c/e[2],await n({x:a,y:c})&&w(o)),s=requestAnimationFrame(T)}function E(r){let{nodeLookup:i,multiSelectionActive:a,nodesDraggable:s,transform:l,snapGrid:u,snapToGrid:p,selectNodesOnDrag:m,onNodeDragStart:h,onSelectionDragStart:g,unselectNodesAndEdges:_}=t();f=!0,(!m||!x)&&!a&&S&&(i.get(S)?.selected||_()),x&&m&&S&&e?.(S);let v=Me(r.sourceEvent,{transform:l,snapGrid:u,snapToGrid:p,containerBounds:d});if(o=v,c=kt(i,s,v,S),c.size>0&&(n||h||!S&&g)){let[e,t]=At({nodeId:S,dragItems:c,nodeLookup:i});n?.(r.sourceEvent,c,e,t),h?.(r.sourceEvent,e,t),S||g?.(r.sourceEvent,t)}}let D=h().clickDistance(C).on(`start`,e=>{let{domNode:n,nodeDragThreshold:r,transform:i,snapGrid:a,snapToGrid:s}=t();d=n?.getBoundingClientRect()||null,m=!1,g=!1,_=e.sourceEvent,r===0&&E(e),o=Me(e.sourceEvent,{transform:i,snapGrid:a,snapToGrid:s,containerBounds:d}),u=X(e.sourceEvent,d)}).on(`drag`,e=>{let{autoPanOnNodeDrag:n,transform:r,snapGrid:i,snapToGrid:a,nodeDragThreshold:s,nodeLookup:p}=t(),h=Me(e.sourceEvent,{transform:r,snapGrid:i,snapToGrid:a,containerBounds:d});if(_=e.sourceEvent,(e.sourceEvent.type===`touchmove`&&e.sourceEvent.touches.length>1||S&&!p.has(S))&&(m=!0),!m){if(!l&&n&&f&&(l=!0,T()),!f){let t=X(e.sourceEvent,d),n=t.x-u.x,r=t.y-u.y;Math.sqrt(n*n+r*r)>s&&E(e)}(o.x!==h.xSnapped||o.y!==h.ySnapped)&&c&&f&&(u=X(e.sourceEvent,d),w(h))}}).on(`end`,e=>{if(!(!f||m)&&(l=!1,f=!1,cancelAnimationFrame(s),c.size>0)){let{nodeLookup:n,updateNodePositions:r,onNodeDragStop:i,onSelectionDragStop:o}=t();if(g&&=(r(c,!1),!1),a||i||!S&&o){let[t,r]=At({nodeId:S,dragItems:c,nodeLookup:n,dragging:!1});a?.(e.sourceEvent,c,t,r),i?.(e.sourceEvent,t,r),S||o?.(e.sourceEvent,r)}}}).filter(e=>{let t=e.target;return!e.button&&(!v||!Ot(t,`.${v}`,b))&&(!y||Ot(t,y,b))});p.call(D)}function y(){p?.on(`.drag`,null)}return{update:v,destroy:y}}function Nt(e,t,n){let r=[],i={x:e.x-n,y:e.y-n,width:n*2,height:n*2};for(let e of t.values())me(i,J(e))>0&&r.push(e);return r}var Pt=250;function Ft(e,t,n,r){let i=[],a=1/0,o=Nt(e,n,t+Pt);for(let n of o){let o=[...n.internals.handleBounds?.source??[],...n.internals.handleBounds?.target??[]];for(let s of o){if(r.nodeId===s.nodeId&&r.type===s.type&&r.id===s.id)continue;let{x:o,y:c}=at(n,s,s.position,!0),l=Math.sqrt((o-e.x)**2+(c-e.y)**2);l>t||(l<a?(i=[{...s,x:o,y:c}],a=l):l===a&&i.push({...s,x:o,y:c}))}}if(!i.length)return null;if(i.length>1){let e=r.type===`source`?`target`:`source`;return i.find(t=>t.type===e)??i[0]}return i[0]}function It(e,t,n,r,i,a=!1){let o=r.get(e);if(!o)return null;let s=i===`strict`?o.internals.handleBounds?.[t]:[...o.internals.handleBounds?.source??[],...o.internals.handleBounds?.target??[]],c=(n?s?.find(e=>e.id===n):s?.[0])??null;return c&&a?{...c,...at(o,c,c.position,!0)}:c}function Lt(e,t){return e||(t?.classList.contains(`target`)?`target`:t?.classList.contains(`source`)?`source`:null)}function Rt(e,t){let n=null;return t?n=!0:e&&!t&&(n=!1),n}var zt=()=>!0;function Bt(e,{connectionMode:t,connectionRadius:n,handleId:r,nodeId:i,edgeUpdaterType:a,isTarget:o,domNode:s,nodeLookup:c,lib:l,autoPanOnConnect:u,flowId:d,panBy:f,cancelConnection:p,onConnectStart:m,onConnect:h,onConnectEnd:g,isValidConnection:_=zt,onReconnectEnd:v,updateConnection:y,getTransform:b,getFromHandle:x,autoPanSpeed:S,dragThreshold:C=1,handleDomNode:w}){let T=Pe(e.target),E=0,D,{x:O,y:k}=X(e),A=Lt(a,w),j=s?.getBoundingClientRect(),M=!1;if(!j||!A)return;let N=It(i,A,r,c,t);if(!N)return;let P=X(e,j),F=!1,I=null,z=!1,B=null;function V(){if(!u||!j)return;let[e,t]=ce(P,j,S);f({x:e,y:t}),E=requestAnimationFrame(V)}let H={...N,nodeId:i,type:A,position:N.position},U=c.get(i),W={inProgress:!0,isValid:null,from:at(U,H,L.Left,!0),fromHandle:H,fromPosition:H.position,fromNode:U,to:P,toHandle:null,toPosition:R[H.position],toNode:null,pointer:P};function G(){M=!0,y(W),m?.(e,{nodeId:i,handleId:r,handleType:A})}C===0&&G();function K(e){if(!M){let{x:t,y:n}=X(e),r=t-O,i=n-k;if(!(r*r+i*i>C*C))return;G()}if(!x()||!H){q(e);return}let a=b();P=X(e,j),D=Ft(ve(P,a,!1,[1,1]),n,c,H),F||=(V(),!0);let s=Vt(e,{handle:D,connectionMode:t,fromNodeId:i,fromHandleId:r,fromType:o?`target`:`source`,isValidConnection:_,doc:T,lib:l,flowId:d,nodeLookup:c});B=s.handleDomNode,I=s.connection,z=Rt(!!D,s.isValid);let u=c.get(i),f=u?at(u,H,L.Left,!0):W.from,p={...W,from:f,isValid:z,to:s.toHandle&&z?ye({x:s.toHandle.x,y:s.toHandle.y},a):P,toHandle:s.toHandle,toPosition:z&&s.toHandle?s.toHandle.position:R[H.position],toNode:s.toHandle?c.get(s.toHandle.nodeId):null,pointer:P};y(p),W=p}function q(e){if(!(`touches`in e&&e.touches.length>0)){if(M){(D||B)&&I&&z&&h?.(I);let{inProgress:t,...n}=W,r={...n,toPosition:W.toHandle?W.toPosition:null};g?.(e,r),a&&v?.(e,r)}p(),cancelAnimationFrame(E),F=!1,z=!1,I=null,B=null,T.removeEventListener(`mousemove`,K),T.removeEventListener(`mouseup`,q),T.removeEventListener(`touchmove`,K),T.removeEventListener(`touchend`,q)}}T.addEventListener(`mousemove`,K),T.addEventListener(`mouseup`,q),T.addEventListener(`touchmove`,K),T.addEventListener(`touchend`,q)}function Vt(e,{handle:t,connectionMode:n,fromNodeId:r,fromHandleId:i,fromType:a,doc:o,lib:s,flowId:c,isValidConnection:l=zt,nodeLookup:u}){let d=a===`target`,f=t?o.querySelector(`.${s}-flow__handle[data-id="${c}-${t?.nodeId}-${t?.id}-${t?.type}"]`):null,{x:p,y:m}=X(e),h=o.elementFromPoint(p,m),g=h?.classList.contains(`${s}-flow__handle`)?h:f,_={handleDomNode:g,isValid:!1,connection:null,toHandle:null};if(g){let e=Lt(void 0,g),t=g.getAttribute(`data-nodeid`),a=g.getAttribute(`data-handleid`),o=g.classList.contains(`connectable`),s=g.classList.contains(`connectableend`);if(!t||!e)return _;let c={source:d?t:r,sourceHandle:d?a:i,target:d?r:t,targetHandle:d?i:a};_.connection=c,_.isValid=o&&s&&(n===j.Strict?d&&e===`source`||!d&&e===`target`:t!==r||a!==i)&&l(c),_.toHandle=It(t,e,a,u,n,!0)}return _}var Ht={onPointerDown:Bt,isValid:Vt};function Ut({domNode:e,panZoom:t,getTransform:n,getViewScale:a}){let o=i(e);function s({translateExtent:e,width:r,height:i,zoomStep:s=1,pannable:c=!0,zoomable:l=!0,inversePan:u=!1}){let d=e=>{if(e.sourceEvent.type!==`wheel`||!t)return;let r=n(),i=e.sourceEvent.ctrlKey&&we()?10:1,a=-e.sourceEvent.deltaY*(e.sourceEvent.deltaMode===1?.05:e.sourceEvent.deltaMode?1:.002)*s,o=r[2]*2**(a*i);t.scaleTo(o)},f=[0,0],p=m().on(`start`,e=>{(e.sourceEvent.type===`mousedown`||e.sourceEvent.type===`touchstart`)&&(f=[e.sourceEvent.clientX??e.sourceEvent.touches[0].clientX,e.sourceEvent.clientY??e.sourceEvent.touches[0].clientY])}).on(`zoom`,c?o=>{let s=n();if(o.sourceEvent.type!==`mousemove`&&o.sourceEvent.type!==`touchmove`||!t)return;let c=[o.sourceEvent.clientX??o.sourceEvent.touches[0].clientX,o.sourceEvent.clientY??o.sourceEvent.touches[0].clientY],l=[c[0]-f[0],c[1]-f[1]];f=c;let d=a()*Math.max(s[2],Math.log(s[2]))*(u?-1:1),p={x:s[0]-l[0]*d,y:s[1]-l[1]*d},m=[[0,0],[r,i]];t.setViewportConstrained({x:p.x,y:p.y,zoom:s[2]},m,e)}:null).on(`zoom.wheel`,l?d:null);o.call(p,{})}function c(){o.on(`zoom`,null)}return{update:s,destroy:c,pointer:r}}var Wt=e=>({x:e.x,y:e.y,zoom:e.k}),Gt=({x:e,y:t,zoom:n})=>l.translate(e,t).scale(n),Kt=(e,t)=>e.target.closest(`.${t}`),qt=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),Jt=e=>((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2,Yt=(e,t=0,n=Jt,r=()=>{})=>{let i=typeof t==`number`&&t>0;return i||r(),i?e.transition().duration(t).ease(n).on(`end`,r):e},Xt=e=>{let t=e.ctrlKey&&we()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t};function Zt({zoomPanValues:e,noWheelClassName:t,d3Selection:n,d3Zoom:i,panOnScrollMode:a,panOnScrollSpeed:o,zoomOnPinch:s,onPanZoomStart:c,onPanZoom:l,onPanZoomEnd:u}){return d=>{if(Kt(d,t))return d.ctrlKey&&d.preventDefault(),!1;d.preventDefault(),d.stopImmediatePropagation();let f=n.property(`__zoom`).k||1;if(d.ctrlKey&&s){let e=r(d),t=f*2**Xt(d);i.scaleTo(n,t,e,d);return}let p=d.deltaMode===1?20:1,m=a===M.Vertical?0:d.deltaX*p,h=a===M.Horizontal?0:d.deltaY*p;!we()&&d.shiftKey&&a!==M.Vertical&&(m=d.deltaY*p,h=0),i.translateBy(n,-(m/f)*o,-(h/f)*o,{internal:!0});let g=Wt(n.property(`__zoom`));clearTimeout(e.panScrollTimeout),e.isPanScrolling?(l?.(d,g),e.panScrollTimeout=setTimeout(()=>{u?.(d,g),e.isPanScrolling=!1},150)):(e.isPanScrolling=!0,c?.(d,g))}}function Qt({noWheelClassName:e,preventScrolling:t,d3ZoomHandler:n}){return function(r,i){let a=r.type===`wheel`,o=!t&&a&&!r.ctrlKey,s=Kt(r,e);if(r.ctrlKey&&a&&s&&r.preventDefault(),o||s)return null;r.preventDefault(),n.call(this,r,i)}}function $t({zoomPanValues:e,onDraggingChange:t,onPanZoomStart:n}){return r=>{if(r.sourceEvent?.internal)return;let i=Wt(r.transform);e.mouseButton=r.sourceEvent?.button||0,e.isZoomingOrPanning=!0,e.prevViewport=i,r.sourceEvent?.type===`mousedown`&&t(!0),n&&n?.(r.sourceEvent,i)}}function en({zoomPanValues:e,panOnDrag:t,onPaneContextMenu:n,onTransformChange:r,onPanZoom:i}){return a=>{e.usedRightMouseButton=!!(n&&qt(t,e.mouseButton??0)),a.sourceEvent?.sync||r([a.transform.x,a.transform.y,a.transform.k]),i&&!a.sourceEvent?.internal&&i?.(a.sourceEvent,Wt(a.transform))}}function tn({zoomPanValues:e,panOnDrag:t,panOnScroll:n,onDraggingChange:r,onPanZoomEnd:i,onPaneContextMenu:a}){return o=>{if(!o.sourceEvent?.internal&&(e.isZoomingOrPanning=!1,a&&qt(t,e.mouseButton??0)&&!e.usedRightMouseButton&&o.sourceEvent&&a(o.sourceEvent),e.usedRightMouseButton=!1,r(!1),i)){let t=Wt(o.transform);e.prevViewport=t,clearTimeout(e.timerId),e.timerId=setTimeout(()=>{i?.(o.sourceEvent,t)},n?150:0)}}}function nn({zoomActivationKeyPressed:e,zoomOnScroll:t,zoomOnPinch:n,panOnDrag:r,panOnScroll:i,zoomOnDoubleClick:a,userSelectionActive:o,noWheelClassName:s,noPanClassName:c,lib:l,connectionInProgress:u}){return d=>{let f=e||t,p=n&&d.ctrlKey,m=d.type===`wheel`;if(d.button===1&&d.type===`mousedown`&&(Kt(d,`${l}-flow__node`)||Kt(d,`${l}-flow__edge`)))return!0;if(!r&&!f&&!i&&!a&&!n||o||u&&!m||Kt(d,s)&&m||Kt(d,c)&&(!m||i&&m&&!e)||!n&&d.ctrlKey&&m)return!1;if(!n&&d.type===`touchstart`&&d.touches?.length>1)return d.preventDefault(),!1;if(!f&&!i&&!p&&m||!r&&(d.type===`mousedown`||d.type===`touchstart`)||Array.isArray(r)&&!r.includes(d.button)&&d.type===`mousedown`)return!1;let h=Array.isArray(r)&&r.includes(d.button)||!d.button||d.button<=1;return(!d.ctrlKey||m)&&h}}function rn({domNode:e,minZoom:t,maxZoom:n,translateExtent:r,viewport:a,onPanZoom:s,onPanZoomStart:c,onPanZoomEnd:l,onDraggingChange:u}){let d={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{x:0,y:0,zoom:0},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},p=e.getBoundingClientRect(),h=m().scaleExtent([t,n]).translateExtent(r),g=i(e).call(h);S({x:a.x,y:a.y,zoom:ie(a.zoom,t,n)},[[0,0],[p.width,p.height]],r);let _=g.on(`wheel.zoom`),v=g.on(`dblclick.zoom`);h.wheelDelta(Xt);function y(e,t){return g?new Promise(n=>{h?.interpolate(t?.interpolate===`linear`?w:o).transform(Yt(g,t?.duration,t?.ease,()=>n(!0)),e)}):Promise.resolve(!1)}function b({noWheelClassName:e,noPanClassName:t,onPaneContextMenu:n,userSelectionActive:r,panOnScroll:i,panOnDrag:a,panOnScrollMode:o,panOnScrollSpeed:f,preventScrolling:p,zoomOnPinch:m,zoomOnScroll:y,zoomOnDoubleClick:b,zoomActivationKeyPressed:S,lib:C,onTransformChange:w,connectionInProgress:T,paneClickDistance:E,selectionOnDrag:D}){r&&!d.isZoomingOrPanning&&x();let O=i&&!S&&!r;h.clickDistance(D?1/0:!Y(E)||E<0?0:E);let k=O?Zt({zoomPanValues:d,noWheelClassName:e,d3Selection:g,d3Zoom:h,panOnScrollMode:o,panOnScrollSpeed:f,zoomOnPinch:m,onPanZoomStart:c,onPanZoom:s,onPanZoomEnd:l}):Qt({noWheelClassName:e,preventScrolling:p,d3ZoomHandler:_});if(g.on(`wheel.zoom`,k,{passive:!1}),!r){let e=$t({zoomPanValues:d,onDraggingChange:u,onPanZoomStart:c});h.on(`start`,e);let t=en({zoomPanValues:d,panOnDrag:a,onPaneContextMenu:!!n,onPanZoom:s,onTransformChange:w});h.on(`zoom`,t);let r=tn({zoomPanValues:d,panOnDrag:a,panOnScroll:i,onPaneContextMenu:n,onPanZoomEnd:l,onDraggingChange:u});h.on(`end`,r)}let A=nn({zoomActivationKeyPressed:S,panOnDrag:a,zoomOnScroll:y,panOnScroll:i,zoomOnDoubleClick:b,zoomOnPinch:m,userSelectionActive:r,noPanClassName:t,noWheelClassName:e,lib:C,connectionInProgress:T});h.filter(A),b?g.on(`dblclick.zoom`,v):g.on(`dblclick.zoom`,null)}function x(){h.on(`zoom`,null)}async function S(e,t,n){let r=Gt(e),i=h?.constrain()(r,t,n);return i&&await y(i),new Promise(e=>e(i))}async function C(e,t){let n=Gt(e);return await y(n,t),new Promise(e=>e(n))}function T(e){if(g){let t=Gt(e),n=g.property(`__zoom`);(n.k!==e.zoom||n.x!==e.x||n.y!==e.y)&&h?.transform(g,t,null,{sync:!0})}}function E(){let e=g?f(g.node()):{x:0,y:0,k:1};return{x:e.x,y:e.y,zoom:e.k}}function D(e,t){return g?new Promise(n=>{h?.interpolate(t?.interpolate===`linear`?w:o).scaleTo(Yt(g,t?.duration,t?.ease,()=>n(!0)),e)}):Promise.resolve(!1)}function O(e,t){return g?new Promise(n=>{h?.interpolate(t?.interpolate===`linear`?w:o).scaleBy(Yt(g,t?.duration,t?.ease,()=>n(!0)),e)}):Promise.resolve(!1)}function k(e){h?.scaleExtent(e)}function A(e){h?.translateExtent(e)}function j(e){let t=!Y(e)||e<0?0:e;h?.clickDistance(t)}return{update:b,destroy:x,setViewport:C,setViewportConstrained:S,getViewport:E,scaleTo:D,scaleBy:O,setScaleExtent:k,setTranslateExtent:A,syncViewport:T,setClickDistance:j}}var an;(function(e){e.Line=`line`,e.Handle=`handle`})(an||={});function on({width:e,prevWidth:t,height:n,prevHeight:r,affectsX:i,affectsY:a}){let o=e-t,s=n-r,c=[o>0?1:o<0?-1:0,s>0?1:s<0?-1:0];return o&&i&&(c[0]*=-1),s&&a&&(c[1]*=-1),c}function sn(e){return{isHorizontal:e.includes(`right`)||e.includes(`left`),isVertical:e.includes(`bottom`)||e.includes(`top`),affectsX:e.includes(`left`),affectsY:e.includes(`top`)}}function cn(e,t){return Math.max(0,t-e)}function ln(e,t){return Math.max(0,e-t)}function un(e,t,n){return Math.max(0,t-e,e-n)}function dn(e,t){return e?!t:t}function fn(e,t,n,r,i,a,o,s){let{affectsX:c,affectsY:l}=t,{isHorizontal:u,isVertical:d}=t,f=u&&d,{xSnapped:p,ySnapped:m}=n,{minWidth:h,maxWidth:g,minHeight:_,maxHeight:v}=r,{x:y,y:b,width:x,height:S,aspectRatio:C}=e,w=Math.floor(u?p-e.pointerX:0),T=Math.floor(d?m-e.pointerY:0),E=x+(c?-w:w),D=S+(l?-T:T),O=-a[0]*x,k=-a[1]*S,A=un(E,h,g),j=un(D,_,v);if(o){let e=0,t=0;c&&w<0?e=cn(y+w+O,o[0][0]):!c&&w>0&&(e=ln(y+E+O,o[1][0])),l&&T<0?t=cn(b+T+k,o[0][1]):!l&&T>0&&(t=ln(b+D+k,o[1][1])),A=Math.max(A,e),j=Math.max(j,t)}if(s){let e=0,t=0;c&&w>0?e=ln(y+w,s[0][0]):!c&&w<0&&(e=cn(y+E,s[1][0])),l&&T>0?t=ln(b+T,s[0][1]):!l&&T<0&&(t=cn(b+D,s[1][1])),A=Math.max(A,e),j=Math.max(j,t)}if(i){if(u){let e=un(E/C,_,v)*C;if(A=Math.max(A,e),o){let e=0;e=!c&&!l||c&&!l&&f?ln(b+k+E/C,o[1][1])*C:cn(b+k+(c?w:-w)/C,o[0][1])*C,A=Math.max(A,e)}if(s){let e=0;e=!c&&!l||c&&!l&&f?cn(b+E/C,s[1][1])*C:ln(b+(c?w:-w)/C,s[0][1])*C,A=Math.max(A,e)}}if(d){let e=un(D*C,h,g)/C;if(j=Math.max(j,e),o){let e=0;e=!c&&!l||l&&!c&&f?ln(y+D*C+O,o[1][0])/C:cn(y+(l?T:-T)*C+O,o[0][0])/C,j=Math.max(j,e)}if(s){let e=0;e=!c&&!l||l&&!c&&f?cn(y+D*C,s[1][0])/C:ln(y+(l?T:-T)*C,s[0][0])/C,j=Math.max(j,e)}}}T+=T<0?j:-j,w+=w<0?A:-A,i&&(f?E>D*C?T=(dn(c,l)?-w:w)/C:w=(dn(c,l)?-T:T)*C:u?(T=w/C,l=c):(w=T*C,c=l));let M=c?y+w:y,N=l?b+T:b;return{width:x+(c?-w:w),height:S+(l?-T:T),x:a[0]*w*(c?-1:1)+M,y:a[1]*T*(l?-1:1)+N}}var pn={width:0,height:0,x:0,y:0},mn={...pn,pointerX:0,pointerY:0,aspectRatio:1};function hn(e){return[[0,0],[e.measured.width,e.measured.height]]}function gn(e,t,n){let r=t.position.x+e.position.x,i=t.position.y+e.position.y,a=e.measured.width??0,o=e.measured.height??0,s=n[0]*a,c=n[1]*o;return[[r-s,i-c],[r+a-s,i+o-c]]}function _n({domNode:e,nodeId:t,getStoreItems:n,onChange:r,onEnd:a}){let o=i(e),s={controlDirection:sn(`bottom-right`),boundaries:{minWidth:0,minHeight:0,maxWidth:Number.MAX_VALUE,maxHeight:Number.MAX_VALUE},resizeDirection:void 0,keepAspectRatio:!1};function c({controlPosition:e,boundaries:i,keepAspectRatio:c,resizeDirection:l,onResizeStart:u,onResize:d,onResizeEnd:f,shouldResize:p}){let m={...pn},g={...mn};s={boundaries:i,resizeDirection:l,keepAspectRatio:c,controlDirection:sn(e)};let _,v=null,y=[],b,x,S,C=!1,w=h().on(`start`,e=>{let{nodeLookup:r,transform:i,snapGrid:a,snapToGrid:o,nodeOrigin:s,paneDomNode:c}=n();if(_=r.get(t),!_)return;v=c?.getBoundingClientRect()??null;let{xSnapped:l,ySnapped:d}=Me(e.sourceEvent,{transform:i,snapGrid:a,snapToGrid:o,containerBounds:v});m={width:_.measured.width??0,height:_.measured.height??0,x:_.position.x??0,y:_.position.y??0},g={...m,pointerX:l,pointerY:d,aspectRatio:m.width/m.height},b=void 0,_.parentId&&(_.extent===`parent`||_.expandParent)&&(b=r.get(_.parentId),x=b&&_.extent===`parent`?hn(b):void 0),y=[],S=void 0;for(let[e,n]of r)if(n.parentId===t&&(y.push({id:e,position:{...n.position},extent:n.extent}),n.extent===`parent`||n.expandParent)){let e=gn(n,_,n.origin??s);S=S?[[Math.min(e[0][0],S[0][0]),Math.min(e[0][1],S[0][1])],[Math.max(e[1][0],S[1][0]),Math.max(e[1][1],S[1][1])]]:e}u?.(e,{...m})}).on(`drag`,e=>{let{transform:t,snapGrid:i,snapToGrid:a,nodeOrigin:o}=n(),c=Me(e.sourceEvent,{transform:t,snapGrid:i,snapToGrid:a,containerBounds:v}),l=[];if(!_)return;let{x:u,y:f,width:h,height:w}=m,T={},E=_.origin??o,{width:D,height:O,x:k,y:A}=fn(g,s.controlDirection,c,s.boundaries,s.keepAspectRatio,E,x,S),j=D!==h,M=O!==w,N=k!==u&&j,P=A!==f&&M;if(!N&&!P&&!j&&!M)return;if((N||P||E[0]===1||E[1]===1)&&(T.x=N?k:m.x,T.y=P?A:m.y,m.x=T.x,m.y=T.y,y.length>0)){let e=k-u,t=A-f;for(let n of y)n.position={x:n.position.x-e+E[0]*(D-h),y:n.position.y-t+E[1]*(O-w)},l.push(n)}if((j||M)&&(T.width=j&&(!s.resizeDirection||s.resizeDirection===`horizontal`)?D:m.width,T.height=M&&(!s.resizeDirection||s.resizeDirection===`vertical`)?O:m.height,m.width=T.width,m.height=T.height),b&&_.expandParent){let e=E[0]*(T.width??0);T.x&&T.x<e&&(m.x=e,g.x-=T.x-e);let t=E[1]*(T.height??0);T.y&&T.y<t&&(m.y=t,g.y-=T.y-t)}let F=on({width:m.width,prevWidth:h,height:m.height,prevHeight:w,affectsX:s.controlDirection.affectsX,affectsY:s.controlDirection.affectsY}),I={...m,direction:F};p?.(e,I)!==!1&&(C=!0,d?.(e,I),r(T,l))}).on(`end`,e=>{C&&=(f?.(e,{...m}),a?.({...m}),!1)});o.call(w)}function l(){o.on(`.drag`,null)}return{update:c,destroy:l}}var vn=_(d(),1),yn=e=>{let t,n=new Set,r=(e,r)=>{let i=typeof e==`function`?e(t):e;if(!Object.is(i,t)){let e=t;t=r??(typeof i!=`object`||!i)?i:Object.assign({},t,i),n.forEach(n=>n(t,e))}},i=()=>t,a={setState:r,getState:i,getInitialState:()=>o,subscribe:e=>(n.add(e),()=>n.delete(e)),destroy:()=>{n.clear()}},o=t=e(r,i,a);return a},bn=e=>e?yn(e):yn,{useDebugValue:xn}=E.default,{useSyncExternalStoreWithSelector:Sn}=vn.default,Cn=e=>e;function wn(e,t=Cn,n){let r=Sn(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return xn(r),r}var Tn=(e,t)=>{let n=bn(e),r=(e,r=t)=>wn(n,e,r);return Object.assign(r,n),r},En=(e,t)=>e?Tn(e,t):Tn;function Z(e,t){if(Object.is(e,t))return!0;if(typeof e!=`object`||!e||typeof t!=`object`||!t)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(let[n,r]of e)if(!Object.is(r,t.get(n)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(let n of e)if(!t.has(n))return!1;return!0}let n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(let r of n)if(!Object.prototype.hasOwnProperty.call(t,r)||!Object.is(e[r],t[r]))return!1;return!0}v();var Dn=(0,E.createContext)(null),On=Dn.Provider,kn=D.error001();function Q(e,t){let n=(0,E.useContext)(Dn);if(n===null)throw Error(kn);return wn(n,e,t)}function $(){let e=(0,E.useContext)(Dn);if(e===null)throw Error(kn);return(0,E.useMemo)(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe}),[e])}var An={display:`none`},jn={position:`absolute`,width:1,height:1,margin:-1,border:0,padding:0,overflow:`hidden`,clip:`rect(0px, 0px, 0px, 0px)`,clipPath:`inset(100%)`},Mn=`react-flow__node-desc`,Nn=`react-flow__edge-desc`,Pn=`react-flow__aria-live`,Fn=e=>e.ariaLiveMessage,In=e=>e.ariaLabelConfig;function Ln({rfId:e}){let t=Q(Fn);return(0,T.jsx)(`div`,{id:`${Pn}-${e}`,"aria-live":`assertive`,"aria-atomic":`true`,style:jn,children:t})}function Rn({rfId:e,disableKeyboardA11y:t}){let n=Q(In);return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(`div`,{id:`${Mn}-${e}`,style:An,children:t?n[`node.a11yDescription.default`]:n[`node.a11yDescription.keyboardDisabled`]}),(0,T.jsx)(`div`,{id:`${Nn}-${e}`,style:An,children:n[`edge.a11yDescription.default`]}),!t&&(0,T.jsx)(Ln,{rfId:e})]})}var zn=(0,E.forwardRef)(({position:e=`top-left`,children:t,className:n,style:r,...i},a)=>(0,T.jsx)(`div`,{className:c([`react-flow__panel`,n,...`${e}`.split(`-`)]),style:r,ref:a,...i,children:t}));zn.displayName=`Panel`;function Bn({proOptions:e,position:t=`bottom-right`}){return e?.hideAttribution?null:(0,T.jsx)(zn,{position:t,className:`react-flow__attribution`,"data-message":`Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev`,children:(0,T.jsx)(`a`,{href:`https://reactflow.dev`,target:`_blank`,rel:`noopener noreferrer`,"aria-label":`React Flow attribution`,children:`React Flow`})})}var Vn=e=>{let t=[],n=[];for(let[,n]of e.nodeLookup)n.selected&&t.push(n.internals.userNode);for(let[,t]of e.edgeLookup)t.selected&&n.push(t);return{selectedNodes:t,selectedEdges:n}},Hn=e=>e.id;function Un(e,t){return Z(e.selectedNodes.map(Hn),t.selectedNodes.map(Hn))&&Z(e.selectedEdges.map(Hn),t.selectedEdges.map(Hn))}function Wn({onSelectionChange:e}){let t=$(),{selectedNodes:n,selectedEdges:r}=Q(Vn,Un);return(0,E.useEffect)(()=>{let i={nodes:n,edges:r};e?.(i),t.getState().onSelectionChangeHandlers.forEach(e=>e(i))},[n,r,e]),null}var Gn=e=>!!e.onSelectionChangeHandlers;function Kn({onSelectionChange:e}){let t=Q(Gn);return e||t?(0,T.jsx)(Wn,{onSelectionChange:e}):null}var qn=[0,0],Jn={x:0,y:0,zoom:1},Yn=[...`nodes.edges.defaultNodes.defaultEdges.onConnect.onConnectStart.onConnectEnd.onClickConnectStart.onClickConnectEnd.nodesDraggable.autoPanOnNodeFocus.nodesConnectable.nodesFocusable.edgesFocusable.edgesReconnectable.elevateNodesOnSelect.elevateEdgesOnSelect.minZoom.maxZoom.nodeExtent.onNodesChange.onEdgesChange.elementsSelectable.connectionMode.snapGrid.snapToGrid.translateExtent.connectOnClick.defaultEdgeOptions.fitView.fitViewOptions.onNodesDelete.onEdgesDelete.onDelete.onNodeDrag.onNodeDragStart.onNodeDragStop.onSelectionDrag.onSelectionDragStart.onSelectionDragStop.onMoveStart.onMove.onMoveEnd.noPanClassName.nodeOrigin.autoPanOnConnect.autoPanOnNodeDrag.onError.connectionRadius.isValidConnection.selectNodesOnDrag.nodeDragThreshold.connectionDragThreshold.onBeforeDelete.debug.autoPanSpeed.ariaLabelConfig.zIndexMode`.split(`.`),`rfId`],Xn=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges}),Zn={translateExtent:O,nodeOrigin:qn,minZoom:.5,maxZoom:2,elementsSelectable:!0,noPanClassName:`nopan`,rfId:`1`};function Qn(e){let{setNodes:t,setEdges:n,setMinZoom:r,setMaxZoom:i,setTranslateExtent:a,setNodeExtent:o,reset:s,setDefaultNodesAndEdges:c}=Q(Xn,Z),l=$();(0,E.useEffect)(()=>(c(e.defaultNodes,e.defaultEdges),()=>{u.current=Zn,s()}),[]);let u=(0,E.useRef)(Zn);return(0,E.useEffect)(()=>{for(let s of Yn){let c=e[s];c!==u.current[s]&&e[s]!==void 0&&(s===`nodes`?t(c):s===`edges`?n(c):s===`minZoom`?r(c):s===`maxZoom`?i(c):s===`translateExtent`?a(c):s===`nodeExtent`?o(c):s===`ariaLabelConfig`?l.setState({ariaLabelConfig:je(c)}):s===`fitView`?l.setState({fitViewQueued:c}):s===`fitViewOptions`?l.setState({fitViewOptions:c}):l.setState({[s]:c}))}u.current=e},Yn.map(t=>e[t])),null}function $n(){return typeof window>`u`||!window.matchMedia?null:window.matchMedia(`(prefers-color-scheme: dark)`)}function er(e){let[t,n]=(0,E.useState)(e===`system`?null:e);return(0,E.useEffect)(()=>{if(e!==`system`){n(e);return}let t=$n(),r=()=>n(t?.matches?`dark`:`light`);return r(),t?.addEventListener(`change`,r),()=>{t?.removeEventListener(`change`,r)}},[e]),t===null?$n()?.matches?`dark`:`light`:t}var tr=typeof document<`u`?document:null;function nr(e=null,t={target:tr,actInsideInputWithModifier:!0}){let[n,r]=(0,E.useState)(!1),i=(0,E.useRef)(!1),a=(0,E.useRef)(new Set([])),[o,s]=(0,E.useMemo)(()=>{if(e!==null){let t=(Array.isArray(e)?e:[e]).filter(e=>typeof e==`string`).map(e=>e.replace(`+`,`
`).replace(`

`,`
+`).split(`
`));return[t,t.reduce((e,t)=>e.concat(...t),[])]}return[[],[]]},[e]);return(0,E.useEffect)(()=>{let n=t?.target??tr,c=t?.actInsideInputWithModifier??!0;if(e!==null){let e=e=>{if(i.current=e.ctrlKey||e.metaKey||e.shiftKey||e.altKey,(!i.current||i.current&&!c)&&Ie(e))return!1;let n=ir(e.code,s);if(a.current.add(e[n]),rr(o,a.current,!1)){let n=e.composedPath?.()?.[0]||e.target,a=n?.nodeName===`BUTTON`||n?.nodeName===`A`;t.preventDefault!==!1&&(i.current||!a)&&e.preventDefault(),r(!0)}},l=e=>{let t=ir(e.code,s);rr(o,a.current,!0)?(r(!1),a.current.clear()):a.current.delete(e[t]),e.key===`Meta`&&a.current.clear(),i.current=!1},u=()=>{a.current.clear(),r(!1)};return n?.addEventListener(`keydown`,e),n?.addEventListener(`keyup`,l),window.addEventListener(`blur`,u),window.addEventListener(`contextmenu`,u),()=>{n?.removeEventListener(`keydown`,e),n?.removeEventListener(`keyup`,l),window.removeEventListener(`blur`,u),window.removeEventListener(`contextmenu`,u)}}},[e,r]),n}function rr(e,t,n){return e.filter(e=>n||e.length===t.size).some(e=>e.every(e=>t.has(e)))}function ir(e,t){return t.includes(e)?`code`:`key`}var ar=()=>{let e=$();return(0,E.useMemo)(()=>({zoomIn:t=>{let{panZoom:n}=e.getState();return n?n.scaleBy(1.2,{duration:t?.duration}):Promise.resolve(!1)},zoomOut:t=>{let{panZoom:n}=e.getState();return n?n.scaleBy(1/1.2,{duration:t?.duration}):Promise.resolve(!1)},zoomTo:(t,n)=>{let{panZoom:r}=e.getState();return r?r.scaleTo(t,{duration:n?.duration}):Promise.resolve(!1)},getZoom:()=>e.getState().transform[2],setViewport:async(t,n)=>{let{transform:[r,i,a],panZoom:o}=e.getState();return o?(await o.setViewport({x:t.x??r,y:t.y??i,zoom:t.zoom??a},n),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>{let[t,n,r]=e.getState().transform;return{x:t,y:n,zoom:r}},setCenter:async(t,n,r)=>e.getState().setCenter(t,n,r),fitBounds:async(t,n)=>{let{width:r,height:i,minZoom:a,maxZoom:o,panZoom:s}=e.getState(),c=Ce(t,r,i,a,o,n?.padding??.1);return s?(await s.setViewport(c,{duration:n?.duration,ease:n?.ease,interpolate:n?.interpolate}),Promise.resolve(!0)):Promise.resolve(!1)},screenToFlowPosition:(t,n={})=>{let{transform:r,snapGrid:i,snapToGrid:a,domNode:o}=e.getState();if(!o)return t;let{x:s,y:c}=o.getBoundingClientRect(),l={x:t.x-s,y:t.y-c},u=n.snapGrid??i;return ve(l,r,n.snapToGrid??a,u)},flowToScreenPosition:t=>{let{transform:n,domNode:r}=e.getState();if(!r)return t;let{x:i,y:a}=r.getBoundingClientRect(),o=ye(t,n);return{x:o.x+i,y:o.y+a}}}),[])};function or(e,t){let n=[],r=new Map,i=[];for(let t of e)if(t.type===`add`){i.push(t);continue}else if(t.type===`remove`||t.type===`replace`)r.set(t.id,[t]);else{let e=r.get(t.id);e?e.push(t):r.set(t.id,[t])}for(let e of t){let t=r.get(e.id);if(!t){n.push(e);continue}if(t[0].type===`remove`)continue;if(t[0].type===`replace`){n.push({...t[0].item});continue}let i={...e};for(let e of t)sr(e,i);n.push(i)}return i.length&&i.forEach(e=>{e.index===void 0?n.push({...e.item}):n.splice(e.index,0,{...e.item})}),n}function sr(e,t){switch(e.type){case`select`:t.selected=e.selected;break;case`position`:e.position!==void 0&&(t.position=e.position),e.dragging!==void 0&&(t.dragging=e.dragging);break;case`dimensions`:e.dimensions!==void 0&&(t.measured={...e.dimensions},e.setAttributes&&((e.setAttributes===!0||e.setAttributes===`width`)&&(t.width=e.dimensions.width),(e.setAttributes===!0||e.setAttributes===`height`)&&(t.height=e.dimensions.height))),typeof e.resizing==`boolean`&&(t.resizing=e.resizing);break}}function cr(e,t){return or(e,t)}function lr(e,t){return or(e,t)}function ur(e,t){return{id:e,type:`select`,selected:t}}function dr(e,t=new Set,n=!1){let r=[];for(let[i,a]of e){let e=t.has(i);!(a.selected===void 0&&!e)&&a.selected!==e&&(n&&(a.selected=e),r.push(ur(a.id,e)))}return r}function fr({items:e=[],lookup:t}){let n=[],r=new Map(e.map(e=>[e.id,e]));for(let[r,i]of e.entries()){let e=t.get(i.id),a=e?.internals?.userNode??e;a!==void 0&&a!==i&&n.push({id:i.id,item:i,type:`replace`}),a===void 0&&n.push({item:i,type:`add`,index:r})}for(let[e]of t)r.get(e)===void 0&&n.push({id:e,type:`remove`});return n}function pr(e){return{id:e.id,type:`remove`}}var mr=e=>V(e),hr=e=>B(e);function gr(e){return(0,E.forwardRef)(e)}var _r=typeof window<`u`?E.useLayoutEffect:E.useEffect;function vr(e){let[t,n]=(0,E.useState)(BigInt(0)),[r]=(0,E.useState)(()=>yr(()=>n(e=>e+BigInt(1))));return _r(()=>{let t=r.get();t.length&&(e(t),r.reset())},[t]),r}function yr(e){let t=[];return{get:()=>t,reset:()=>{t=[]},push:n=>{t.push(n),e()}}}var br=(0,E.createContext)(null);function xr({children:e}){let t=$(),n=vr((0,E.useCallback)(e=>{let{nodes:n=[],setNodes:r,hasDefaultNodes:i,onNodesChange:a,nodeLookup:o,fitViewQueued:s,onNodesChangeMiddlewareMap:c}=t.getState(),l=n;for(let t of e)l=typeof t==`function`?t(l):t;let u=fr({items:l,lookup:o});for(let e of c.values())u=e(u);i&&r(l),u.length>0?a?.(u):s&&window.requestAnimationFrame(()=>{let{fitViewQueued:e,nodes:n,setNodes:r}=t.getState();e&&r(n)})},[])),r=vr((0,E.useCallback)(e=>{let{edges:n=[],setEdges:r,hasDefaultEdges:i,onEdgesChange:a,edgeLookup:o}=t.getState(),s=n;for(let t of e)s=typeof t==`function`?t(s):t;i?r(s):a&&a(fr({items:s,lookup:o}))},[])),i=(0,E.useMemo)(()=>({nodeQueue:n,edgeQueue:r}),[]);return(0,T.jsx)(br.Provider,{value:i,children:e})}function Sr(){let e=(0,E.useContext)(br);if(!e)throw Error(`useBatchContext must be used within a BatchProvider`);return e}var Cr=e=>!!e.panZoom;function wr(){let e=ar(),t=$(),n=Sr(),r=Q(Cr),i=(0,E.useMemo)(()=>{let e=e=>t.getState().nodeLookup.get(e),r=e=>{n.nodeQueue.push(e)},i=e=>{n.edgeQueue.push(e)},a=e=>{let{nodeLookup:n,nodeOrigin:r}=t.getState(),i=mr(e)?e:n.get(e.id),a=i.parentId?Oe(i.position,i.measured,i.parentId,n,r):i.position;return J({...i,position:a,width:i.measured?.width??i.width,height:i.measured?.height??i.height})},o=(e,t,n={replace:!1})=>{r(r=>r.map(r=>{if(r.id===e){let e=typeof t==`function`?t(r):t;return n.replace&&mr(e)?e:{...r,...e}}return r}))},s=(e,t,n={replace:!1})=>{i(r=>r.map(r=>{if(r.id===e){let e=typeof t==`function`?t(r):t;return n.replace&&hr(e)?e:{...r,...e}}return r}))};return{getNodes:()=>t.getState().nodes.map(e=>({...e})),getNode:t=>e(t)?.internals.userNode,getInternalNode:e,getEdges:()=>{let{edges:e=[]}=t.getState();return e.map(e=>({...e}))},getEdge:e=>t.getState().edgeLookup.get(e),setNodes:r,setEdges:i,addNodes:e=>{let t=Array.isArray(e)?e:[e];n.nodeQueue.push(e=>[...e,...t])},addEdges:e=>{let t=Array.isArray(e)?e:[e];n.edgeQueue.push(e=>[...e,...t])},toObject:()=>{let{nodes:e=[],edges:n=[],transform:r}=t.getState(),[i,a,o]=r;return{nodes:e.map(e=>({...e})),edges:n.map(e=>({...e})),viewport:{x:i,y:a,zoom:o}}},deleteElements:async({nodes:e=[],edges:n=[]})=>{let{nodes:r,edges:i,onNodesDelete:a,onEdgesDelete:o,triggerNodeChanges:s,triggerEdgeChanges:c,onDelete:l,onBeforeDelete:u}=t.getState(),{nodes:d,edges:f}=await re({nodesToRemove:e,edgesToRemove:n,nodes:r,edges:i,onBeforeDelete:u}),p=f.length>0,m=d.length>0;if(p){let e=f.map(pr);o?.(f),c(e)}if(m){let e=d.map(pr);a?.(d),s(e)}return(m||p)&&l?.({nodes:d,edges:f}),{deletedNodes:d,deletedEdges:f}},getIntersectingNodes:(e,n=!0,r)=>{let i=he(e),o=i?e:a(e),s=r!==void 0;return o?(r||t.getState().nodes).filter(r=>{let a=t.getState().nodeLookup.get(r.id);if(a&&!i&&(r.id===e.id||!a.internals.positionAbsolute))return!1;let c=J(s?r:a),l=me(c,o);return n&&l>0||l>=c.width*c.height||l>=o.width*o.height}):[]},isNodeIntersecting:(e,t,n=!0)=>{let r=he(e)?e:a(e);if(!r)return!1;let i=me(r,t);return n&&i>0||i>=t.width*t.height||i>=r.width*r.height},updateNode:o,updateNodeData:(e,t,n={replace:!1})=>{o(e,e=>{let r=typeof t==`function`?t(e):t;return n.replace?{...e,data:r}:{...e,data:{...e.data,...r}}},n)},updateEdge:s,updateEdgeData:(e,t,n={replace:!1})=>{s(e,e=>{let r=typeof t==`function`?t(e):t;return n.replace?{...e,data:r}:{...e,data:{...e.data,...r}}},n)},getNodesBounds:e=>{let{nodeLookup:n,nodeOrigin:r}=t.getState();return W(e,{nodeLookup:n,nodeOrigin:r})},getHandleConnections:({type:e,id:n,nodeId:r})=>Array.from(t.getState().connectionLookup.get(`${r}-${e}${n?`-${n}`:``}`)?.values()??[]),getNodeConnections:({type:e,handleId:n,nodeId:r})=>Array.from(t.getState().connectionLookup.get(`${r}${e?n?`-${e}-${n}`:`-${e}`:``}`)?.values()??[]),fitView:async e=>{let r=t.getState().fitViewResolver??Ae();return t.setState({fitViewQueued:!0,fitViewOptions:e,fitViewResolver:r}),n.nodeQueue.push(e=>[...e]),r.promise}}},[]);return(0,E.useMemo)(()=>({...i,...e,viewportInitialized:r}),[r])}var Tr=e=>e.selected,Er=typeof window<`u`?window:void 0;function Dr({deleteKeyCode:e,multiSelectionKeyCode:t}){let n=$(),{deleteElements:r}=wr(),i=nr(e,{actInsideInputWithModifier:!1}),a=nr(t,{target:Er});(0,E.useEffect)(()=>{if(i){let{edges:e,nodes:t}=n.getState();r({nodes:t.filter(Tr),edges:e.filter(Tr)}),n.setState({nodesSelectionActive:!1})}},[i]),(0,E.useEffect)(()=>{n.setState({multiSelectionActive:a})},[a])}function Or(e){let t=$();(0,E.useEffect)(()=>{let n=()=>{if(!e.current||!(e.current.checkVisibility?.()??!0))return!1;let n=Ne(e.current);(n.height===0||n.width===0)&&t.getState().onError?.(`004`,D.error004()),t.setState({width:n.width||500,height:n.height||500})};if(e.current){n(),window.addEventListener(`resize`,n);let t=new ResizeObserver(()=>n());return t.observe(e.current),()=>{window.removeEventListener(`resize`,n),t&&e.current&&t.unobserve(e.current)}}},[])}var kr={position:`absolute`,width:`100%`,height:`100%`,top:0,left:0},Ar=e=>({userSelectionActive:e.userSelectionActive,lib:e.lib,connectionInProgress:e.connection.inProgress});function jr({onPaneContextMenu:e,zoomOnScroll:t=!0,zoomOnPinch:n=!0,panOnScroll:r=!1,panOnScrollSpeed:i=.5,panOnScrollMode:a=M.Free,zoomOnDoubleClick:o=!0,panOnDrag:s=!0,defaultViewport:c,translateExtent:l,minZoom:u,maxZoom:d,zoomActivationKeyCode:f,preventScrolling:p=!0,children:m,noWheelClassName:h,noPanClassName:g,onViewportChange:_,isControlledViewport:v,paneClickDistance:y,selectionOnDrag:b}){let x=$(),S=(0,E.useRef)(null),{userSelectionActive:C,lib:w,connectionInProgress:D}=Q(Ar,Z),O=nr(f),k=(0,E.useRef)();Or(S);let A=(0,E.useCallback)(e=>{_?.({x:e[0],y:e[1],zoom:e[2]}),v||x.setState({transform:e})},[_,v]);return(0,E.useEffect)(()=>{if(S.current){k.current=rn({domNode:S.current,minZoom:u,maxZoom:d,translateExtent:l,viewport:c,onDraggingChange:e=>x.setState({paneDragging:e}),onPanZoomStart:(e,t)=>{let{onViewportChangeStart:n,onMoveStart:r}=x.getState();r?.(e,t),n?.(t)},onPanZoom:(e,t)=>{let{onViewportChange:n,onMove:r}=x.getState();r?.(e,t),n?.(t)},onPanZoomEnd:(e,t)=>{let{onViewportChangeEnd:n,onMoveEnd:r}=x.getState();r?.(e,t),n?.(t)}});let{x:e,y:t,zoom:n}=k.current.getViewport();return x.setState({panZoom:k.current,transform:[e,t,n],domNode:S.current.closest(`.react-flow`)}),()=>{k.current?.destroy()}}},[]),(0,E.useEffect)(()=>{k.current?.update({onPaneContextMenu:e,zoomOnScroll:t,zoomOnPinch:n,panOnScroll:r,panOnScrollSpeed:i,panOnScrollMode:a,zoomOnDoubleClick:o,panOnDrag:s,zoomActivationKeyPressed:O,preventScrolling:p,noPanClassName:g,userSelectionActive:C,noWheelClassName:h,lib:w,onTransformChange:A,connectionInProgress:D,selectionOnDrag:b,paneClickDistance:y})},[e,t,n,r,i,a,o,s,O,p,g,C,h,w,A,D,b,y]),(0,T.jsx)(`div`,{className:`react-flow__renderer`,ref:S,style:kr,children:m})}var Mr=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function Nr(){let{userSelectionActive:e,userSelectionRect:t}=Q(Mr,Z);return e&&t?(0,T.jsx)(`div`,{className:`react-flow__selection react-flow__container`,style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}var Pr=(e,t)=>n=>{n.target===t.current&&e?.(n)},Fr=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,connectionInProgress:e.connection.inProgress,dragging:e.paneDragging});function Ir({isSelecting:e,selectionKeyPressed:t,selectionMode:n=N.Full,panOnDrag:r,paneClickDistance:i,selectionOnDrag:a,onSelectionStart:o,onSelectionEnd:s,onPaneClick:l,onPaneContextMenu:u,onPaneScroll:d,onPaneMouseEnter:f,onPaneMouseMove:p,onPaneMouseLeave:m,children:h}){let g=$(),{userSelectionActive:_,elementsSelectable:v,dragging:y,connectionInProgress:b}=Q(Fr,Z),x=v&&(e||_),S=(0,E.useRef)(null),C=(0,E.useRef)(),w=(0,E.useRef)(new Set),D=(0,E.useRef)(new Set),O=(0,E.useRef)(!1),k=e=>{if(O.current||b){O.current=!1;return}l?.(e),g.getState().resetSelectedElements(),g.setState({nodesSelectionActive:!1})},A=e=>{if(Array.isArray(r)&&r?.includes(2)){e.preventDefault();return}u?.(e)},j=d?e=>d(e):void 0;return(0,T.jsxs)(`div`,{className:c([`react-flow__pane`,{draggable:r===!0||Array.isArray(r)&&r.includes(0),dragging:y,selection:e}]),onClick:x?void 0:Pr(k,S),onContextMenu:Pr(A,S),onWheel:Pr(j,S),onPointerEnter:x?void 0:f,onPointerMove:x?e=>{let{userSelectionRect:r,transform:a,nodeLookup:s,edgeLookup:c,connectionLookup:l,triggerNodeChanges:u,triggerEdgeChanges:d,defaultEdgeOptions:f,resetSelectedElements:p}=g.getState();if(!C.current||!r)return;let{x:m,y:h}=X(e.nativeEvent,C.current),{startX:_,startY:v}=r;if(!O.current){let n=t?0:i;if(Math.hypot(m-_,h-v)<=n)return;p(),o?.(e)}O.current=!0;let y={startX:_,startY:v,x:m<_?m:_,y:h<v?h:v,width:Math.abs(m-_),height:Math.abs(h-v)},b=w.current,x=D.current;w.current=new Set(K(s,y,a,n===N.Partial,!0).map(e=>e.id)),D.current=new Set;let S=f?.selectable??!0;for(let e of w.current){let t=l.get(e);if(t)for(let{edgeId:e}of t.values()){let t=c.get(e);t&&(t.selectable??S)&&D.current.add(e)}}ke(b,w.current)||u(dr(s,w.current,!0)),ke(x,D.current)||d(dr(c,D.current)),g.setState({userSelectionRect:y,userSelectionActive:!0,nodesSelectionActive:!1})}:p,onPointerUp:x?e=>{e.button===0&&(e.target?.releasePointerCapture?.(e.pointerId),!_&&e.target===S.current&&g.getState().userSelectionRect&&k?.(e),g.setState({userSelectionActive:!1,userSelectionRect:null}),O.current&&(s?.(e),g.setState({nodesSelectionActive:w.current.size>0})))}:void 0,onPointerDownCapture:x?n=>{let{domNode:r}=g.getState();if(C.current=r?.getBoundingClientRect(),!C.current)return;let i=n.target===S.current;if(!i&&n.target.closest(`.nokey`)||!e||!(a&&i||t)||n.button!==0||!n.isPrimary)return;n.target?.setPointerCapture?.(n.pointerId),O.current=!1;let{x:o,y:s}=X(n.nativeEvent,C.current);g.setState({userSelectionRect:{width:0,height:0,startX:o,startY:s,x:o,y:s}}),i||(n.stopPropagation(),n.preventDefault())}:void 0,onClickCapture:x?e=>{O.current&&=(e.stopPropagation(),!1)}:void 0,onPointerLeave:m,ref:S,style:kr,children:[h,(0,T.jsx)(Nr,{})]})}function Lr({id:e,store:t,unselect:n=!1,nodeRef:r}){let{addSelectedNodes:i,unselectNodesAndEdges:a,multiSelectionActive:o,nodeLookup:s,onError:c}=t.getState(),l=s.get(e);if(!l){c?.(`012`,D.error012(e));return}t.setState({nodesSelectionActive:!1}),l.selected?(n||l.selected&&o)&&(a({nodes:[l],edges:[]}),requestAnimationFrame(()=>r?.current?.blur())):i([e])}function Rr({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:r,nodeId:i,isSelectable:a,nodeClickDistance:o}){let s=$(),[c,l]=(0,E.useState)(!1),u=(0,E.useRef)();return(0,E.useEffect)(()=>{u.current=Mt({getStoreItems:()=>s.getState(),onNodeMouseDown:t=>{Lr({id:t,store:s,nodeRef:e})},onDragStart:()=>{l(!0)},onDragStop:()=>{l(!1)}})},[]),(0,E.useEffect)(()=>{if(t)u.current?.destroy();else if(e.current)return u.current?.update({noDragClassName:n,handleSelector:r,domNode:e.current,isSelectable:a,nodeId:i,nodeClickDistance:o}),()=>{u.current?.destroy()}},[n,r,t,a,e,i]),c}var zr=e=>t=>t.selected&&(t.draggable||e&&t.draggable===void 0);function Br(){let e=$();return(0,E.useCallback)(t=>{let{nodeExtent:n,snapToGrid:r,snapGrid:i,nodesDraggable:a,onError:o,updateNodePositions:s,nodeLookup:c,nodeOrigin:l}=e.getState(),u=new Map,d=zr(a),f=r?i[0]:5,p=r?i[1]:5,m=t.direction.x*f*t.factor,h=t.direction.y*p*t.factor;for(let[,e]of c){if(!d(e))continue;let t={x:e.internals.positionAbsolute.x+m,y:e.internals.positionAbsolute.y+h};r&&(t=_e(t,i));let{position:a,positionAbsolute:s}=ne({nodeId:e.id,nextPosition:t,nodeLookup:c,nodeExtent:n,nodeOrigin:l,onError:o});e.position=a,e.internals.positionAbsolute=s,u.set(e.id,e)}s(u)},[])}var Vr=(0,E.createContext)(null),Hr=Vr.Provider;Vr.Consumer;var Ur=()=>(0,E.useContext)(Vr),Wr=e=>({connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName,rfId:e.rfId}),Gr=(e,t,n)=>r=>{let{connectionClickStartHandle:i,connectionMode:a,connection:o}=r,{fromHandle:s,toHandle:c,isValid:l}=o,u=c?.nodeId===e&&c?.id===t&&c?.type===n;return{connectingFrom:s?.nodeId===e&&s?.id===t&&s?.type===n,connectingTo:u,clickConnecting:i?.nodeId===e&&i?.id===t&&i?.type===n,isPossibleEndHandle:a===j.Strict?s?.type!==n:e!==s?.nodeId||t!==s?.id,connectionInProcess:!!s,clickConnectionInProcess:!!i,valid:u&&l}};function Kr({type:e=`source`,position:t=L.Top,isValidConnection:n,isConnectable:r=!0,isConnectableStart:i=!0,isConnectableEnd:a=!0,id:o,onConnect:s,children:l,className:u,onMouseDown:d,onTouchStart:f,...p},m){let h=o||null,g=e===`target`,_=$(),v=Ur(),{connectOnClick:y,noPanClassName:b,rfId:x}=Q(Wr,Z),{connectingFrom:S,connectingTo:C,clickConnecting:w,isPossibleEndHandle:E,connectionInProcess:O,clickConnectionInProcess:k,valid:A}=Q(Gr(v,h,e),Z);v||_.getState().onError?.(`010`,D.error010());let j=e=>{let{defaultEdgeOptions:t,onConnect:n,hasDefaultEdges:r}=_.getState(),i={...t,...e};if(r){let{edges:e,setEdges:t}=_.getState();t(Je(i,e))}n?.(i),s?.(i)},M=e=>{if(!v)return;let t=Le(e.nativeEvent);if(i&&(t&&e.button===0||!t)){let t=_.getState();Ht.onPointerDown(e.nativeEvent,{handleDomNode:e.currentTarget,autoPanOnConnect:t.autoPanOnConnect,connectionMode:t.connectionMode,connectionRadius:t.connectionRadius,domNode:t.domNode,nodeLookup:t.nodeLookup,lib:t.lib,isTarget:g,handleId:h,nodeId:v,flowId:t.rfId,panBy:t.panBy,cancelConnection:t.cancelConnection,onConnectStart:t.onConnectStart,onConnectEnd:t.onConnectEnd,updateConnection:t.updateConnection,onConnect:j,isValidConnection:n||t.isValidConnection,getTransform:()=>_.getState().transform,getFromHandle:()=>_.getState().connection.fromHandle,autoPanSpeed:t.autoPanSpeed,dragThreshold:t.connectionDragThreshold})}t?d?.(e):f?.(e)},N=t=>{let{onClickConnectStart:r,onClickConnectEnd:a,connectionClickStartHandle:o,connectionMode:s,isValidConnection:c,lib:l,rfId:u,nodeLookup:d,connection:f}=_.getState();if(!v||!o&&!i)return;if(!o){r?.(t.nativeEvent,{nodeId:v,handleId:h,handleType:e}),_.setState({connectionClickStartHandle:{nodeId:v,type:e,id:h}});return}let p=Pe(t.target),m=n||c,{connection:g,isValid:y}=Ht.isValid(t.nativeEvent,{handle:{nodeId:v,id:h,type:e},connectionMode:s,fromNodeId:o.nodeId,fromHandleId:o.id||null,fromType:o.type,isValidConnection:m,flowId:u,doc:p,lib:l,nodeLookup:d});y&&g&&j(g);let b=structuredClone(f);delete b.inProgress,b.toPosition=b.toHandle?b.toHandle.position:null,a?.(t,b),_.setState({connectionClickStartHandle:null})};return(0,T.jsx)(`div`,{"data-handleid":h,"data-nodeid":v,"data-handlepos":t,"data-id":`${x}-${v}-${h}-${e}`,className:c([`react-flow__handle`,`react-flow__handle-${t}`,`nodrag`,b,u,{source:!g,target:g,connectable:r,connectablestart:i,connectableend:a,clickconnecting:w,connectingfrom:S,connectingto:C,valid:A,connectionindicator:r&&(!O||E)&&(O||k?a:i)}]),onMouseDown:M,onTouchStart:M,onClick:y?N:void 0,ref:m,...p,children:l})}var qr=(0,E.memo)(gr(Kr));function Jr({data:e,isConnectable:t,sourcePosition:n=L.Bottom}){return(0,T.jsxs)(T.Fragment,{children:[e?.label,(0,T.jsx)(qr,{type:`source`,position:n,isConnectable:t})]})}function Yr({data:e,isConnectable:t,targetPosition:n=L.Top,sourcePosition:r=L.Bottom}){return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(qr,{type:`target`,position:n,isConnectable:t}),e?.label,(0,T.jsx)(qr,{type:`source`,position:r,isConnectable:t})]})}function Xr(){return null}function Zr({data:e,isConnectable:t,targetPosition:n=L.Top}){return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(qr,{type:`target`,position:n,isConnectable:t}),e?.label]})}var Qr={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}},$r={input:Jr,default:Yr,output:Zr,group:Xr};function ei(e){return e.internals.handleBounds===void 0?{width:e.width??e.initialWidth??e.style?.width,height:e.height??e.initialHeight??e.style?.height}:{width:e.width??e.style?.width,height:e.height??e.style?.height}}var ti=e=>{let{width:t,height:n,x:r,y:i}=G(e.nodeLookup,{filter:e=>!!e.selected});return{width:Y(t)?t:null,height:Y(n)?n:null,userSelectionActive:e.userSelectionActive,transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]}) translate(${r}px,${i}px)`}};function ni({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){let r=$(),{width:i,height:a,transformString:o,userSelectionActive:s}=Q(ti,Z),l=Br(),u=(0,E.useRef)(null);if((0,E.useEffect)(()=>{n||u.current?.focus({preventScroll:!0})},[n]),Rr({nodeRef:u}),s||!i||!a)return null;let d=e?t=>{e(t,r.getState().nodes.filter(e=>e.selected))}:void 0;return(0,T.jsx)(`div`,{className:c([`react-flow__nodesselection`,`react-flow__container`,t]),style:{transform:o},children:(0,T.jsx)(`div`,{ref:u,className:`react-flow__nodesselection-rect`,onContextMenu:d,tabIndex:n?void 0:-1,onKeyDown:n?void 0:e=>{Object.prototype.hasOwnProperty.call(Qr,e.key)&&(e.preventDefault(),l({direction:Qr[e.key],factor:e.shiftKey?4:1}))},style:{width:i,height:a}})})}var ri=typeof window<`u`?window:void 0,ii=e=>({nodesSelectionActive:e.nodesSelectionActive,userSelectionActive:e.userSelectionActive});function ai({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:i,onPaneContextMenu:a,onPaneScroll:o,paneClickDistance:s,deleteKeyCode:c,selectionKeyCode:l,selectionOnDrag:u,selectionMode:d,onSelectionStart:f,onSelectionEnd:p,multiSelectionKeyCode:m,panActivationKeyCode:h,zoomActivationKeyCode:g,elementsSelectable:_,zoomOnScroll:v,zoomOnPinch:y,panOnScroll:b,panOnScrollSpeed:x,panOnScrollMode:S,zoomOnDoubleClick:C,panOnDrag:w,defaultViewport:E,translateExtent:D,minZoom:O,maxZoom:k,preventScrolling:A,onSelectionContextMenu:j,noWheelClassName:M,noPanClassName:N,disableKeyboardA11y:P,onViewportChange:F,isControlledViewport:I}){let{nodesSelectionActive:L,userSelectionActive:R}=Q(ii,Z),z=nr(l,{target:ri}),B=nr(h,{target:ri}),V=B||w,H=B||b,U=u&&V!==!0,W=z||R||U;return Dr({deleteKeyCode:c,multiSelectionKeyCode:m}),(0,T.jsx)(jr,{onPaneContextMenu:a,elementsSelectable:_,zoomOnScroll:v,zoomOnPinch:y,panOnScroll:H,panOnScrollSpeed:x,panOnScrollMode:S,zoomOnDoubleClick:C,panOnDrag:!z&&V,defaultViewport:E,translateExtent:D,minZoom:O,maxZoom:k,zoomActivationKeyCode:g,preventScrolling:A,noWheelClassName:M,noPanClassName:N,onViewportChange:F,isControlledViewport:I,paneClickDistance:s,selectionOnDrag:U,children:(0,T.jsxs)(Ir,{onSelectionStart:f,onSelectionEnd:p,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:i,onPaneContextMenu:a,onPaneScroll:o,panOnDrag:V,isSelecting:!!W,selectionMode:d,selectionKeyPressed:z,paneClickDistance:s,selectionOnDrag:U,children:[e,L&&(0,T.jsx)(ni,{onSelectionContextMenu:j,noPanClassName:N,disableKeyboardA11y:P})]})})}ai.displayName=`FlowRenderer`;var oi=(0,E.memo)(ai),si=e=>t=>e?K(t.nodeLookup,{x:0,y:0,width:t.width,height:t.height},t.transform,!0).map(e=>e.id):Array.from(t.nodeLookup.keys());function ci(e){return Q((0,E.useCallback)(si(e),[e]),Z)}var li=e=>e.updateNodeInternals;function ui(){let e=Q(li),[t]=(0,E.useState)(()=>typeof ResizeObserver>`u`?null:new ResizeObserver(t=>{let n=new Map;t.forEach(e=>{let t=e.target.getAttribute(`data-id`);n.set(t,{id:t,nodeElement:e.target,force:!0})}),e(n)}));return(0,E.useEffect)(()=>()=>{t?.disconnect()},[t]),t}function di({node:e,nodeType:t,hasDimensions:n,resizeObserver:r}){let i=$(),a=(0,E.useRef)(null),o=(0,E.useRef)(null),s=(0,E.useRef)(e.sourcePosition),c=(0,E.useRef)(e.targetPosition),l=(0,E.useRef)(t),u=n&&!!e.internals.handleBounds;return(0,E.useEffect)(()=>{a.current&&!e.hidden&&(!u||o.current!==a.current)&&(o.current&&r?.unobserve(o.current),r?.observe(a.current),o.current=a.current)},[u,e.hidden]),(0,E.useEffect)(()=>()=>{o.current&&=(r?.unobserve(o.current),null)},[]),(0,E.useEffect)(()=>{if(a.current){let n=l.current!==t,r=s.current!==e.sourcePosition,o=c.current!==e.targetPosition;(n||r||o)&&(l.current=t,s.current=e.sourcePosition,c.current=e.targetPosition,i.getState().updateNodeInternals(new Map([[e.id,{id:e.id,nodeElement:a.current,force:!0}]])))}},[e.id,t,e.sourcePosition,e.targetPosition]),a}function fi({id:e,onClick:t,onMouseEnter:n,onMouseMove:r,onMouseLeave:i,onContextMenu:a,onDoubleClick:o,nodesDraggable:s,elementsSelectable:l,nodesConnectable:u,nodesFocusable:d,resizeObserver:f,noDragClassName:p,noPanClassName:m,disableKeyboardA11y:h,rfId:g,nodeTypes:_,nodeClickDistance:v,onError:y}){let{node:b,internals:x,isParent:S}=Q(t=>{let n=t.nodeLookup.get(e),r=t.parentLookup.has(e);return{node:n,internals:n.internals,isParent:r}},Z),C=b.type||`default`,w=_?.[C]||$r[C];w===void 0&&(y?.(`003`,D.error003(C)),C=`default`,w=_?.default||$r.default);let E=!!(b.draggable||s&&b.draggable===void 0),O=!!(b.selectable||l&&b.selectable===void 0),A=!!(b.connectable||u&&b.connectable===void 0),j=!!(b.focusable||d&&b.focusable===void 0),M=$(),N=De(b),P=di({node:b,nodeType:C,hasDimensions:N,resizeObserver:f}),F=Rr({nodeRef:P,disabled:b.hidden||!E,noDragClassName:p,handleSelector:b.dragHandle,nodeId:e,isSelectable:O,nodeClickDistance:v}),I=Br();if(b.hidden)return null;let L=Ee(b),R=ei(b),z=O||E||t||n||r||i,B=n?e=>n(e,{...x.userNode}):void 0,V=r?e=>r(e,{...x.userNode}):void 0,H=i?e=>i(e,{...x.userNode}):void 0,U=a?e=>a(e,{...x.userNode}):void 0,W=o?e=>o(e,{...x.userNode}):void 0,G=n=>{let{selectNodesOnDrag:r,nodeDragThreshold:i}=M.getState();O&&(!r||!E||i>0)&&Lr({id:e,store:M,nodeRef:P}),t&&t(n,{...x.userNode})},q=t=>{if(!(Ie(t.nativeEvent)||h)){if(k.includes(t.key)&&O)Lr({id:e,store:M,unselect:t.key===`Escape`,nodeRef:P});else if(E&&b.selected&&Object.prototype.hasOwnProperty.call(Qr,t.key)){t.preventDefault();let{ariaLabelConfig:e}=M.getState();M.setState({ariaLiveMessage:e[`node.a11yDescription.ariaLiveMessage`]({direction:t.key.replace(`Arrow`,``).toLowerCase(),x:~~x.positionAbsolute.x,y:~~x.positionAbsolute.y})}),I({direction:Qr[t.key],factor:t.shiftKey?4:1})}}},ee=()=>{if(h||!P.current?.matches(`:focus-visible`))return;let{transform:t,width:n,height:r,autoPanOnNodeFocus:i,setCenter:a}=M.getState();i&&(K(new Map([[e,b]]),{x:0,y:0,width:n,height:r},t,!0).length>0||a(b.position.x+L.width/2,b.position.y+L.height/2,{zoom:t[2]}))};return(0,T.jsx)(`div`,{className:c([`react-flow__node`,`react-flow__node-${C}`,{[m]:E},b.className,{selected:b.selected,selectable:O,parent:S,draggable:E,dragging:F}]),ref:P,style:{zIndex:x.z,transform:`translate(${x.positionAbsolute.x}px,${x.positionAbsolute.y}px)`,pointerEvents:z?`all`:`none`,visibility:N?`visible`:`hidden`,...b.style,...R},"data-id":e,"data-testid":`rf__node-${e}`,onMouseEnter:B,onMouseMove:V,onMouseLeave:H,onContextMenu:U,onClick:G,onDoubleClick:W,onKeyDown:j?q:void 0,tabIndex:j?0:void 0,onFocus:j?ee:void 0,role:b.ariaRole??(j?`group`:void 0),"aria-roledescription":`node`,"aria-describedby":h?void 0:`${Mn}-${g}`,"aria-label":b.ariaLabel,...b.domAttributes,children:(0,T.jsx)(Hr,{value:e,children:(0,T.jsx)(w,{id:e,data:b.data,type:C,positionAbsoluteX:x.positionAbsolute.x,positionAbsoluteY:x.positionAbsolute.y,selected:b.selected??!1,selectable:O,draggable:E,deletable:b.deletable??!0,isConnectable:A,sourcePosition:b.sourcePosition,targetPosition:b.targetPosition,dragging:F,dragHandle:b.dragHandle,zIndex:x.z,parentId:b.parentId,...L})})})}var pi=(0,E.memo)(fi),mi=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,onError:e.onError});function hi(e){let{nodesDraggable:t,nodesConnectable:n,nodesFocusable:r,elementsSelectable:i,onError:a}=Q(mi,Z),o=ci(e.onlyRenderVisibleElements),s=ui();return(0,T.jsx)(`div`,{className:`react-flow__nodes`,style:kr,children:o.map(o=>(0,T.jsx)(pi,{id:o,nodeTypes:e.nodeTypes,nodeExtent:e.nodeExtent,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,resizeObserver:s,nodesDraggable:t,nodesConnectable:n,nodesFocusable:r,elementsSelectable:i,nodeClickDistance:e.nodeClickDistance,onError:a},o))})}hi.displayName=`NodeRenderer`;var gi=(0,E.memo)(hi);function _i(e){return Q((0,E.useCallback)(t=>{if(!e)return t.edges.map(e=>e.id);let n=[];if(t.width&&t.height)for(let e of t.edges){let r=t.nodeLookup.get(e.source),i=t.nodeLookup.get(e.target);r&&i&&Ge({sourceNode:r,targetNode:i,width:t.width,height:t.height,transform:t.transform})&&n.push(e.id)}return n},[e]),Z)}var vi=({color:e=`none`,strokeWidth:t=1})=>(0,T.jsx)(`polyline`,{className:`arrow`,style:{strokeWidth:t,...e&&{stroke:e}},strokeLinecap:`round`,fill:`none`,strokeLinejoin:`round`,points:`-5,-4 0,0 -5,4`}),yi=({color:e=`none`,strokeWidth:t=1})=>(0,T.jsx)(`polyline`,{className:`arrowclosed`,style:{strokeWidth:t,...e&&{stroke:e,fill:e}},strokeLinecap:`round`,strokeLinejoin:`round`,points:`-5,-4 0,0 -5,4 -5,-4`}),bi={[I.Arrow]:vi,[I.ArrowClosed]:yi};function xi(e){let t=$();return(0,E.useMemo)(()=>Object.prototype.hasOwnProperty.call(bi,e)?bi[e]:(t.getState().onError?.(`009`,D.error009(e)),null),[e])}var Si=({id:e,type:t,color:n,width:r=12.5,height:i=12.5,markerUnits:a=`strokeWidth`,strokeWidth:o,orient:s=`auto-start-reverse`})=>{let c=xi(t);return c?(0,T.jsx)(`marker`,{className:`react-flow__arrowhead`,id:e,markerWidth:`${r}`,markerHeight:`${i}`,viewBox:`-10 -10 20 20`,markerUnits:a,orient:s,refX:`0`,refY:`0`,children:(0,T.jsx)(c,{color:n,strokeWidth:o})}):null},Ci=({defaultColor:e,rfId:t})=>{let n=Q(e=>e.edges),r=Q(e=>e.defaultEdgeOptions),i=(0,E.useMemo)(()=>ct(n,{id:t,defaultColor:e,defaultMarkerStart:r?.markerStart,defaultMarkerEnd:r?.markerEnd}),[n,r,t,e]);return i.length?(0,T.jsx)(`svg`,{className:`react-flow__marker`,"aria-hidden":`true`,children:(0,T.jsx)(`defs`,{children:i.map(e=>(0,T.jsx)(Si,{id:e.id,type:e.type,color:e.color,width:e.width,height:e.height,markerUnits:e.markerUnits,strokeWidth:e.strokeWidth,orient:e.orient},e.id))})}):null};Ci.displayName=`MarkerDefinitions`;var wi=(0,E.memo)(Ci);function Ti({x:e,y:t,label:n,labelStyle:r,labelShowBg:i=!0,labelBgStyle:a,labelBgPadding:o=[2,4],labelBgBorderRadius:s=2,children:l,className:u,...d}){let[f,p]=(0,E.useState)({x:1,y:0,width:0,height:0}),m=c([`react-flow__edge-textwrapper`,u]),h=(0,E.useRef)(null);return(0,E.useEffect)(()=>{if(h.current){let e=h.current.getBBox();p({x:e.x,y:e.y,width:e.width,height:e.height})}},[n]),n?(0,T.jsxs)(`g`,{transform:`translate(${e-f.width/2} ${t-f.height/2})`,className:m,visibility:f.width?`visible`:`hidden`,...d,children:[i&&(0,T.jsx)(`rect`,{width:f.width+2*o[0],x:-o[0],y:-o[1],height:f.height+2*o[1],className:`react-flow__edge-textbg`,style:a,rx:s,ry:s}),(0,T.jsx)(`text`,{className:`react-flow__edge-text`,y:f.height/2,dy:`0.3em`,ref:h,style:r,children:n}),l]}):null}Ti.displayName=`EdgeText`;var Ei=(0,E.memo)(Ti);function Di({path:e,labelX:t,labelY:n,label:r,labelStyle:i,labelShowBg:a,labelBgStyle:o,labelBgPadding:s,labelBgBorderRadius:l,interactionWidth:u=20,...d}){return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(`path`,{...d,d:e,fill:`none`,className:c([`react-flow__edge-path`,d.className])}),u?(0,T.jsx)(`path`,{d:e,fill:`none`,strokeOpacity:0,strokeWidth:u,className:`react-flow__edge-interaction`}):null,r&&Y(t)&&Y(n)?(0,T.jsx)(Ei,{x:t,y:n,label:r,labelStyle:i,labelShowBg:a,labelBgStyle:o,labelBgPadding:s,labelBgBorderRadius:l}):null]})}function Oi({pos:e,x1:t,y1:n,x2:r,y2:i}){return e===L.Left||e===L.Right?[.5*(t+r),n]:[t,.5*(n+i)]}function ki({sourceX:e,sourceY:t,sourcePosition:n=L.Bottom,targetX:r,targetY:i,targetPosition:a=L.Top}){let[o,s]=Oi({pos:n,x1:e,y1:t,x2:r,y2:i}),[c,l]=Oi({pos:a,x1:r,y1:i,x2:e,y2:t}),[u,d,f,p]=ze({sourceX:e,sourceY:t,targetX:r,targetY:i,sourceControlX:o,sourceControlY:s,targetControlX:c,targetControlY:l});return[`M${e},${t} C${o},${s} ${c},${l} ${r},${i}`,u,d,f,p]}function Ai(e){return(0,E.memo)(({id:t,sourceX:n,sourceY:r,targetX:i,targetY:a,sourcePosition:o,targetPosition:s,label:c,labelStyle:l,labelShowBg:u,labelBgStyle:d,labelBgPadding:f,labelBgBorderRadius:p,style:m,markerEnd:h,markerStart:g,interactionWidth:_})=>{let[v,y,b]=ki({sourceX:n,sourceY:r,sourcePosition:o,targetX:i,targetY:a,targetPosition:s});return(0,T.jsx)(Di,{id:e.isInternal?void 0:t,path:v,labelX:y,labelY:b,label:c,labelStyle:l,labelShowBg:u,labelBgStyle:d,labelBgPadding:f,labelBgBorderRadius:p,style:m,markerEnd:h,markerStart:g,interactionWidth:_})})}var ji=Ai({isInternal:!1}),Mi=Ai({isInternal:!0});ji.displayName=`SimpleBezierEdge`,Mi.displayName=`SimpleBezierEdgeInternal`;function Ni(e){return(0,E.memo)(({id:t,sourceX:n,sourceY:r,targetX:i,targetY:a,label:o,labelStyle:s,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:d,style:f,sourcePosition:p=L.Bottom,targetPosition:m=L.Top,markerEnd:h,markerStart:g,pathOptions:_,interactionWidth:v})=>{let[y,b,x]=tt({sourceX:n,sourceY:r,sourcePosition:p,targetX:i,targetY:a,targetPosition:m,borderRadius:_?.borderRadius,offset:_?.offset,stepPosition:_?.stepPosition});return(0,T.jsx)(Di,{id:e.isInternal?void 0:t,path:y,labelX:b,labelY:x,label:o,labelStyle:s,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:d,style:f,markerEnd:h,markerStart:g,interactionWidth:v})})}var Pi=Ni({isInternal:!1}),Fi=Ni({isInternal:!0});Pi.displayName=`SmoothStepEdge`,Fi.displayName=`SmoothStepEdgeInternal`;function Ii(e){return(0,E.memo)(({id:t,...n})=>{let r=e.isInternal?void 0:t;return(0,T.jsx)(Pi,{...n,id:r,pathOptions:(0,E.useMemo)(()=>({borderRadius:0,offset:n.pathOptions?.offset}),[n.pathOptions?.offset])})})}var Li=Ii({isInternal:!1}),Ri=Ii({isInternal:!0});Li.displayName=`StepEdge`,Ri.displayName=`StepEdgeInternal`;function zi(e){return(0,E.memo)(({id:t,sourceX:n,sourceY:r,targetX:i,targetY:a,label:o,labelStyle:s,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:d,style:f,markerEnd:p,markerStart:m,interactionWidth:h})=>{let[g,_,v]=Ye({sourceX:n,sourceY:r,targetX:i,targetY:a});return(0,T.jsx)(Di,{id:e.isInternal?void 0:t,path:g,labelX:_,labelY:v,label:o,labelStyle:s,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:d,style:f,markerEnd:p,markerStart:m,interactionWidth:h})})}var Bi=zi({isInternal:!1}),Vi=zi({isInternal:!0});Bi.displayName=`StraightEdge`,Vi.displayName=`StraightEdgeInternal`;function Hi(e){return(0,E.memo)(({id:t,sourceX:n,sourceY:r,targetX:i,targetY:a,sourcePosition:o=L.Bottom,targetPosition:s=L.Top,label:c,labelStyle:l,labelShowBg:u,labelBgStyle:d,labelBgPadding:f,labelBgBorderRadius:p,style:m,markerEnd:h,markerStart:g,pathOptions:_,interactionWidth:v})=>{let[y,b,x]=He({sourceX:n,sourceY:r,sourcePosition:o,targetX:i,targetY:a,targetPosition:s,curvature:_?.curvature});return(0,T.jsx)(Di,{id:e.isInternal?void 0:t,path:y,labelX:b,labelY:x,label:c,labelStyle:l,labelShowBg:u,labelBgStyle:d,labelBgPadding:f,labelBgBorderRadius:p,style:m,markerEnd:h,markerStart:g,interactionWidth:v})})}var Ui=Hi({isInternal:!1}),Wi=Hi({isInternal:!0});Ui.displayName=`BezierEdge`,Wi.displayName=`BezierEdgeInternal`;var Gi={default:Wi,straight:Vi,step:Ri,smoothstep:Fi,simplebezier:Mi},Ki={sourceX:null,sourceY:null,targetX:null,targetY:null,sourcePosition:null,targetPosition:null},qi=(e,t,n)=>n===L.Left?e-t:n===L.Right?e+t:e,Ji=(e,t,n)=>n===L.Top?e-t:n===L.Bottom?e+t:e,Yi=`react-flow__edgeupdater`;function Xi({position:e,centerX:t,centerY:n,radius:r=10,onMouseDown:i,onMouseEnter:a,onMouseOut:o,type:s}){return(0,T.jsx)(`circle`,{onMouseDown:i,onMouseEnter:a,onMouseOut:o,className:c([Yi,`${Yi}-${s}`]),cx:qi(t,r,e),cy:Ji(n,r,e),r,stroke:`transparent`,fill:`transparent`})}function Zi({isReconnectable:e,reconnectRadius:t,edge:n,sourceX:r,sourceY:i,targetX:a,targetY:o,sourcePosition:s,targetPosition:c,onReconnect:l,onReconnectStart:u,onReconnectEnd:d,setReconnecting:f,setUpdateHover:p}){let m=$(),h=(e,t)=>{if(e.button!==0)return;let{autoPanOnConnect:r,domNode:i,isValidConnection:a,connectionMode:o,connectionRadius:s,lib:c,onConnectStart:p,onConnectEnd:h,cancelConnection:g,nodeLookup:_,rfId:v,panBy:y,updateConnection:b}=m.getState(),x=t.type===`target`;Ht.onPointerDown(e.nativeEvent,{autoPanOnConnect:r,connectionMode:o,connectionRadius:s,domNode:i,handleId:t.id,nodeId:t.nodeId,nodeLookup:_,isTarget:x,edgeUpdaterType:t.type,lib:c,flowId:v,cancelConnection:g,panBy:y,isValidConnection:a,onConnect:e=>l?.(n,e),onConnectStart:(r,i)=>{f(!0),u?.(e,n,t.type),p?.(r,i)},onConnectEnd:h,onReconnectEnd:(e,r)=>{f(!1),d?.(e,n,t.type,r)},updateConnection:b,getTransform:()=>m.getState().transform,getFromHandle:()=>m.getState().connection.fromHandle,dragThreshold:m.getState().connectionDragThreshold,handleDomNode:e.currentTarget})},g=e=>h(e,{nodeId:n.target,id:n.targetHandle??null,type:`target`}),_=e=>h(e,{nodeId:n.source,id:n.sourceHandle??null,type:`source`}),v=()=>p(!0),y=()=>p(!1);return(0,T.jsxs)(T.Fragment,{children:[(e===!0||e===`source`)&&(0,T.jsx)(Xi,{position:s,centerX:r,centerY:i,radius:t,onMouseDown:g,onMouseEnter:v,onMouseOut:y,type:`source`}),(e===!0||e===`target`)&&(0,T.jsx)(Xi,{position:c,centerX:a,centerY:o,radius:t,onMouseDown:_,onMouseEnter:v,onMouseOut:y,type:`target`})]})}function Qi({id:e,edgesFocusable:t,edgesReconnectable:n,elementsSelectable:r,onClick:i,onDoubleClick:a,onContextMenu:o,onMouseEnter:s,onMouseMove:l,onMouseLeave:u,reconnectRadius:d,onReconnect:f,onReconnectStart:p,onReconnectEnd:m,rfId:h,edgeTypes:g,noPanClassName:_,onError:v,disableKeyboardA11y:y}){let b=Q(t=>t.edgeLookup.get(e)),x=Q(e=>e.defaultEdgeOptions);b=x?{...x,...b}:b;let S=b.type||`default`,C=g?.[S]||Gi[S];C===void 0&&(v?.(`011`,D.error011(S)),S=`default`,C=g?.default||Gi.default);let w=!!(b.focusable||t&&b.focusable===void 0),O=f!==void 0&&(b.reconnectable||n&&b.reconnectable===void 0),A=!!(b.selectable||r&&b.selectable===void 0),j=(0,E.useRef)(null),[M,N]=(0,E.useState)(!1),[P,F]=(0,E.useState)(!1),I=$(),{zIndex:L,sourceX:R,sourceY:z,targetX:B,targetY:V,sourcePosition:H,targetPosition:U}=Q((0,E.useCallback)(t=>{let n=t.nodeLookup.get(b.source),r=t.nodeLookup.get(b.target);if(!n||!r)return{zIndex:b.zIndex,...Ki};let i=rt({id:e,sourceNode:n,targetNode:r,sourceHandle:b.sourceHandle||null,targetHandle:b.targetHandle||null,connectionMode:t.connectionMode,onError:v});return{zIndex:We({selected:b.selected,zIndex:b.zIndex,sourceNode:n,targetNode:r,elevateOnSelect:t.elevateEdgesOnSelect,zIndexMode:t.zIndexMode}),...i||Ki}},[b.source,b.target,b.sourceHandle,b.targetHandle,b.selected,b.zIndex]),Z),W=(0,E.useMemo)(()=>b.markerStart?`url('#${st(b.markerStart,h)}')`:void 0,[b.markerStart,h]),G=(0,E.useMemo)(()=>b.markerEnd?`url('#${st(b.markerEnd,h)}')`:void 0,[b.markerEnd,h]);if(b.hidden||R===null||z===null||B===null||V===null)return null;let K=t=>{let{addSelectedEdges:n,unselectNodesAndEdges:r,multiSelectionActive:a}=I.getState();A&&(I.setState({nodesSelectionActive:!1}),b.selected&&a?(r({nodes:[],edges:[b]}),j.current?.blur()):n([e])),i&&i(t,b)},q=a?e=>{a(e,{...b})}:void 0,ee=o?e=>{o(e,{...b})}:void 0,te=s?e=>{s(e,{...b})}:void 0,ne=l?e=>{l(e,{...b})}:void 0,re=u?e=>{u(e,{...b})}:void 0;return(0,T.jsx)(`svg`,{style:{zIndex:L},children:(0,T.jsxs)(`g`,{className:c([`react-flow__edge`,`react-flow__edge-${S}`,b.className,_,{selected:b.selected,animated:b.animated,inactive:!A&&!i,updating:M,selectable:A}]),onClick:K,onDoubleClick:q,onContextMenu:ee,onMouseEnter:te,onMouseMove:ne,onMouseLeave:re,onKeyDown:w?t=>{if(!y&&k.includes(t.key)&&A){let{unselectNodesAndEdges:n,addSelectedEdges:r}=I.getState();t.key===`Escape`?(j.current?.blur(),n({edges:[b]})):r([e])}}:void 0,tabIndex:w?0:void 0,role:b.ariaRole??(w?`group`:`img`),"aria-roledescription":`edge`,"data-id":e,"data-testid":`rf__edge-${e}`,"aria-label":b.ariaLabel===null?void 0:b.ariaLabel||`Edge from ${b.source} to ${b.target}`,"aria-describedby":w?`${Nn}-${h}`:void 0,ref:j,...b.domAttributes,children:[!P&&(0,T.jsx)(C,{id:e,source:b.source,target:b.target,type:b.type,selected:b.selected,animated:b.animated,selectable:A,deletable:b.deletable??!0,label:b.label,labelStyle:b.labelStyle,labelShowBg:b.labelShowBg,labelBgStyle:b.labelBgStyle,labelBgPadding:b.labelBgPadding,labelBgBorderRadius:b.labelBgBorderRadius,sourceX:R,sourceY:z,targetX:B,targetY:V,sourcePosition:H,targetPosition:U,data:b.data,style:b.style,sourceHandleId:b.sourceHandle,targetHandleId:b.targetHandle,markerStart:W,markerEnd:G,pathOptions:`pathOptions`in b?b.pathOptions:void 0,interactionWidth:b.interactionWidth}),O&&(0,T.jsx)(Zi,{edge:b,isReconnectable:O,reconnectRadius:d,onReconnect:f,onReconnectStart:p,onReconnectEnd:m,sourceX:R,sourceY:z,targetX:B,targetY:V,sourcePosition:H,targetPosition:U,setUpdateHover:N,setReconnecting:F})]})})}var $i=(0,E.memo)(Qi),ea=e=>({edgesFocusable:e.edgesFocusable,edgesReconnectable:e.edgesReconnectable,elementsSelectable:e.elementsSelectable,connectionMode:e.connectionMode,onError:e.onError});function ta({defaultMarkerColor:e,onlyRenderVisibleElements:t,rfId:n,edgeTypes:r,noPanClassName:i,onReconnect:a,onEdgeContextMenu:o,onEdgeMouseEnter:s,onEdgeMouseMove:c,onEdgeMouseLeave:l,onEdgeClick:u,reconnectRadius:d,onEdgeDoubleClick:f,onReconnectStart:p,onReconnectEnd:m,disableKeyboardA11y:h}){let{edgesFocusable:g,edgesReconnectable:_,elementsSelectable:v,onError:y}=Q(ea,Z),b=_i(t);return(0,T.jsxs)(`div`,{className:`react-flow__edges`,children:[(0,T.jsx)(wi,{defaultColor:e,rfId:n}),b.map(e=>(0,T.jsx)($i,{id:e,edgesFocusable:g,edgesReconnectable:_,elementsSelectable:v,noPanClassName:i,onReconnect:a,onContextMenu:o,onMouseEnter:s,onMouseMove:c,onMouseLeave:l,onClick:u,reconnectRadius:d,onDoubleClick:f,onReconnectStart:p,onReconnectEnd:m,rfId:n,onError:y,edgeTypes:r,disableKeyboardA11y:h},e))]})}ta.displayName=`EdgeRenderer`;var na=(0,E.memo)(ta),ra=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function ia({children:e}){return(0,T.jsx)(`div`,{className:`react-flow__viewport xyflow__viewport react-flow__container`,style:{transform:Q(ra)},children:e})}function aa(e){let t=wr(),n=(0,E.useRef)(!1);(0,E.useEffect)(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}var oa=e=>e.panZoom?.syncViewport;function sa(e){let t=Q(oa),n=$();return(0,E.useEffect)(()=>{e&&(t?.(e),n.setState({transform:[e.x,e.y,e.zoom]}))},[e,t]),null}function ca(e){return e.connection.inProgress?{...e.connection,to:ve(e.connection.to,e.transform)}:{...e.connection}}function la(e){return e?t=>e(ca(t)):ca}function ua(e){return Q(la(e),Z)}var da=e=>({nodesConnectable:e.nodesConnectable,isValid:e.connection.isValid,inProgress:e.connection.inProgress,width:e.width,height:e.height});function fa({containerStyle:e,style:t,type:n,component:r}){let{nodesConnectable:i,width:a,height:o,isValid:s,inProgress:l}=Q(da,Z);return a&&i&&l?(0,T.jsx)(`svg`,{style:e,width:a,height:o,className:`react-flow__connectionline react-flow__container`,children:(0,T.jsx)(`g`,{className:c([`react-flow__connection`,z(s)]),children:(0,T.jsx)(pa,{style:t,type:n,CustomComponent:r,isValid:s})})}):null}var pa=({style:e,type:t=F.Bezier,CustomComponent:n,isValid:r})=>{let{inProgress:i,from:a,fromNode:o,fromHandle:s,fromPosition:c,to:l,toNode:u,toHandle:d,toPosition:f,pointer:p}=ua();if(!i)return;if(n)return(0,T.jsx)(n,{connectionLineType:t,connectionLineStyle:e,fromNode:o,fromHandle:s,fromX:a.x,fromY:a.y,toX:l.x,toY:l.y,fromPosition:c,toPosition:f,connectionStatus:z(r),toNode:u,toHandle:d,pointer:p});let m=``,h={sourceX:a.x,sourceY:a.y,sourcePosition:c,targetX:l.x,targetY:l.y,targetPosition:f};switch(t){case F.Bezier:[m]=He(h);break;case F.SimpleBezier:[m]=ki(h);break;case F.Step:[m]=tt({...h,borderRadius:0});break;case F.SmoothStep:[m]=tt(h);break;default:[m]=Ye(h)}return(0,T.jsx)(`path`,{d:m,fill:`none`,className:`react-flow__connection-path`,style:e})};pa.displayName=`ConnectionLine`;var ma={};function ha(e=ma){(0,E.useRef)(e),$(),(0,E.useEffect)(()=>{},[e])}function ga(){$(),(0,E.useRef)(!1),(0,E.useEffect)(()=>{},[])}function _a({nodeTypes:e,edgeTypes:t,onInit:n,onNodeClick:r,onEdgeClick:i,onNodeDoubleClick:a,onEdgeDoubleClick:o,onNodeMouseEnter:s,onNodeMouseMove:c,onNodeMouseLeave:l,onNodeContextMenu:u,onSelectionContextMenu:d,onSelectionStart:f,onSelectionEnd:p,connectionLineType:m,connectionLineStyle:h,connectionLineComponent:g,connectionLineContainerStyle:_,selectionKeyCode:v,selectionOnDrag:y,selectionMode:b,multiSelectionKeyCode:x,panActivationKeyCode:S,zoomActivationKeyCode:C,deleteKeyCode:w,onlyRenderVisibleElements:E,elementsSelectable:D,defaultViewport:O,translateExtent:k,minZoom:A,maxZoom:j,preventScrolling:M,defaultMarkerColor:N,zoomOnScroll:P,zoomOnPinch:F,panOnScroll:I,panOnScrollSpeed:L,panOnScrollMode:R,zoomOnDoubleClick:z,panOnDrag:B,onPaneClick:V,onPaneMouseEnter:H,onPaneMouseMove:U,onPaneMouseLeave:W,onPaneScroll:G,onPaneContextMenu:K,paneClickDistance:q,nodeClickDistance:ee,onEdgeContextMenu:te,onEdgeMouseEnter:ne,onEdgeMouseMove:re,onEdgeMouseLeave:ie,reconnectRadius:ae,onReconnect:oe,onReconnectStart:se,onReconnectEnd:ce,noDragClassName:le,noWheelClassName:ue,noPanClassName:de,disableKeyboardA11y:J,nodeExtent:fe,rfId:pe,viewport:me,onViewportChange:he}){return ha(e),ha(t),ga(),aa(n),sa(me),(0,T.jsx)(oi,{onPaneClick:V,onPaneMouseEnter:H,onPaneMouseMove:U,onPaneMouseLeave:W,onPaneContextMenu:K,onPaneScroll:G,paneClickDistance:q,deleteKeyCode:w,selectionKeyCode:v,selectionOnDrag:y,selectionMode:b,onSelectionStart:f,onSelectionEnd:p,multiSelectionKeyCode:x,panActivationKeyCode:S,zoomActivationKeyCode:C,elementsSelectable:D,zoomOnScroll:P,zoomOnPinch:F,zoomOnDoubleClick:z,panOnScroll:I,panOnScrollSpeed:L,panOnScrollMode:R,panOnDrag:B,defaultViewport:O,translateExtent:k,minZoom:A,maxZoom:j,onSelectionContextMenu:d,preventScrolling:M,noDragClassName:le,noWheelClassName:ue,noPanClassName:de,disableKeyboardA11y:J,onViewportChange:he,isControlledViewport:!!me,children:(0,T.jsxs)(ia,{children:[(0,T.jsx)(na,{edgeTypes:t,onEdgeClick:i,onEdgeDoubleClick:o,onReconnect:oe,onReconnectStart:se,onReconnectEnd:ce,onlyRenderVisibleElements:E,onEdgeContextMenu:te,onEdgeMouseEnter:ne,onEdgeMouseMove:re,onEdgeMouseLeave:ie,reconnectRadius:ae,defaultMarkerColor:N,noPanClassName:de,disableKeyboardA11y:J,rfId:pe}),(0,T.jsx)(fa,{style:h,type:m,component:g,containerStyle:_}),(0,T.jsx)(`div`,{className:`react-flow__edgelabel-renderer`}),(0,T.jsx)(gi,{nodeTypes:e,onNodeClick:r,onNodeDoubleClick:a,onNodeMouseEnter:s,onNodeMouseMove:c,onNodeMouseLeave:l,onNodeContextMenu:u,nodeClickDistance:ee,onlyRenderVisibleElements:E,noPanClassName:de,noDragClassName:le,disableKeyboardA11y:J,nodeExtent:fe,rfId:pe}),(0,T.jsx)(`div`,{className:`react-flow__viewport-portal`})]})})}_a.displayName=`GraphView`;var va=(0,E.memo)(_a),ya=({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:i,height:a,fitView:o,fitViewOptions:s,minZoom:c=.5,maxZoom:l=2,nodeOrigin:u,nodeExtent:d,zIndexMode:f=`basic`}={})=>{let p=new Map,m=new Map,h=new Map,g=new Map,_=r??t??[],v=n??e??[],y=u??[0,0],b=d??O;Et(h,g,_);let x=_t(v,p,m,{nodeOrigin:y,nodeExtent:b,zIndexMode:f}),S=[0,0,1];if(o&&i&&a){let{x:e,y:t,zoom:n}=Ce(G(p,{filter:e=>!!((e.width||e.initialWidth)&&(e.height||e.initialHeight))}),i,a,c,l,s?.padding??.1);S=[e,t,n]}return{rfId:`1`,width:i??0,height:a??0,transform:S,nodes:v,nodesInitialized:x,nodeLookup:p,parentLookup:m,edges:_,edgeLookup:g,connectionLookup:h,onNodesChange:null,onEdgesChange:null,hasDefaultNodes:n!==void 0,hasDefaultEdges:r!==void 0,panZoom:null,minZoom:c,maxZoom:l,translateExtent:O,nodeExtent:b,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionMode:j.Strict,domNode:null,paneDragging:!1,noPanClassName:`nopan`,nodeOrigin:y,nodeDragThreshold:1,connectionDragThreshold:1,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesReconnectable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,elevateEdgesOnSelect:!0,selectNodesOnDrag:!0,multiSelectionActive:!1,fitViewQueued:o??!1,fitViewOptions:s,fitViewResolver:null,connection:{...P},connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:``,autoPanOnConnect:!0,autoPanOnNodeDrag:!0,autoPanOnNodeFocus:!0,autoPanSpeed:15,connectionRadius:20,onError:ge,isValidConnection:void 0,onSelectionChangeHandlers:[],lib:`react`,debug:!1,ariaLabelConfig:A,zIndexMode:f,onNodesChangeMiddlewareMap:new Map,onEdgesChangeMiddlewareMap:new Map}},ba=({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:i,height:a,fitView:o,fitViewOptions:s,minZoom:c,maxZoom:l,nodeOrigin:u,nodeExtent:d,zIndexMode:f})=>En((p,m)=>{async function h(){let{nodeLookup:e,panZoom:t,fitViewOptions:n,fitViewResolver:r,width:i,height:a,minZoom:o,maxZoom:s}=m();t&&(await te({nodes:e,width:i,height:a,panZoom:t,minZoom:o,maxZoom:s},n),r?.resolve(!0),p({fitViewResolver:null}))}return{...ya({nodes:e,edges:t,width:i,height:a,fitView:o,fitViewOptions:s,minZoom:c,maxZoom:l,nodeOrigin:u,nodeExtent:d,defaultNodes:n,defaultEdges:r,zIndexMode:f}),setNodes:e=>{let{nodeLookup:t,parentLookup:n,nodeOrigin:r,elevateNodesOnSelect:i,fitViewQueued:a,zIndexMode:o}=m(),s=_t(e,t,n,{nodeOrigin:r,nodeExtent:d,elevateNodesOnSelect:i,checkEquality:!0,zIndexMode:o});a&&s?(h(),p({nodes:e,nodesInitialized:s,fitViewQueued:!1,fitViewOptions:void 0})):p({nodes:e,nodesInitialized:s})},setEdges:e=>{let{connectionLookup:t,edgeLookup:n}=m();Et(t,n,e),p({edges:e})},setDefaultNodesAndEdges:(e,t)=>{if(e){let{setNodes:t}=m();t(e),p({hasDefaultNodes:!0})}if(t){let{setEdges:e}=m();e(t),p({hasDefaultEdges:!0})}},updateNodeInternals:e=>{let{triggerNodeChanges:t,nodeLookup:n,parentLookup:r,domNode:i,nodeOrigin:a,nodeExtent:o,debug:s,fitViewQueued:c,zIndexMode:l}=m(),{changes:u,updatedInternals:d}=Ct(e,n,r,i,a,o,l);d&&(mt(n,r,{nodeOrigin:a,nodeExtent:o,zIndexMode:l}),c?(h(),p({fitViewQueued:!1,fitViewOptions:void 0})):p({}),u?.length>0&&(s&&console.log(`React Flow: trigger node changes`,u),t?.(u)))},updateNodePositions:(e,t=!1)=>{let n=[],r=[],{nodeLookup:i,triggerNodeChanges:a,connection:o,updateConnection:s,onNodesChangeMiddlewareMap:c}=m();for(let[a,c]of e){let e=i.get(a),l=!!(e?.expandParent&&e?.parentId&&c?.position),u={id:a,type:`position`,position:l?{x:Math.max(0,c.position.x),y:Math.max(0,c.position.y)}:c.position,dragging:t};if(e&&o.inProgress&&o.fromNode.id===e.id){let t=at(e,o.fromHandle,L.Left,!0);s({...o,from:t})}l&&e.parentId&&n.push({id:a,parentId:e.parentId,rect:{...c.internals.positionAbsolute,width:c.measured.width??0,height:c.measured.height??0}}),r.push(u)}if(n.length>0){let{parentLookup:e,nodeOrigin:t}=m(),a=St(n,i,e,t);r.push(...a)}for(let e of c.values())r=e(r);a(r)},triggerNodeChanges:e=>{let{onNodesChange:t,setNodes:n,nodes:r,hasDefaultNodes:i,debug:a}=m();e?.length&&(i&&n(cr(e,r)),a&&console.log(`React Flow: trigger node changes`,e),t?.(e))},triggerEdgeChanges:e=>{let{onEdgesChange:t,setEdges:n,edges:r,hasDefaultEdges:i,debug:a}=m();e?.length&&(i&&n(lr(e,r)),a&&console.log(`React Flow: trigger edge changes`,e),t?.(e))},addSelectedNodes:e=>{let{multiSelectionActive:t,edgeLookup:n,nodeLookup:r,triggerNodeChanges:i,triggerEdgeChanges:a}=m();if(t){i(e.map(e=>ur(e,!0)));return}i(dr(r,new Set([...e]),!0)),a(dr(n))},addSelectedEdges:e=>{let{multiSelectionActive:t,edgeLookup:n,nodeLookup:r,triggerNodeChanges:i,triggerEdgeChanges:a}=m();if(t){a(e.map(e=>ur(e,!0)));return}a(dr(n,new Set([...e]))),i(dr(r,new Set,!0))},unselectNodesAndEdges:({nodes:e,edges:t}={})=>{let{edges:n,nodes:r,nodeLookup:i,triggerNodeChanges:a,triggerEdgeChanges:o}=m(),s=e||r,c=t||n,l=s.map(e=>{let t=i.get(e.id);return t&&(t.selected=!1),ur(e.id,!1)}),u=c.map(e=>ur(e.id,!1));a(l),o(u)},setMinZoom:e=>{let{panZoom:t,maxZoom:n}=m();t?.setScaleExtent([e,n]),p({minZoom:e})},setMaxZoom:e=>{let{panZoom:t,minZoom:n}=m();t?.setScaleExtent([n,e]),p({maxZoom:e})},setTranslateExtent:e=>{m().panZoom?.setTranslateExtent(e),p({translateExtent:e})},resetSelectedElements:()=>{let{edges:e,nodes:t,triggerNodeChanges:n,triggerEdgeChanges:r,elementsSelectable:i}=m();if(!i)return;let a=t.reduce((e,t)=>t.selected?[...e,ur(t.id,!1)]:e,[]),o=e.reduce((e,t)=>t.selected?[...e,ur(t.id,!1)]:e,[]);n(a),r(o)},setNodeExtent:e=>{let{nodes:t,nodeLookup:n,parentLookup:r,nodeOrigin:i,elevateNodesOnSelect:a,nodeExtent:o,zIndexMode:s}=m();e[0][0]===o[0][0]&&e[0][1]===o[0][1]&&e[1][0]===o[1][0]&&e[1][1]===o[1][1]||(_t(t,n,r,{nodeOrigin:i,nodeExtent:e,elevateNodesOnSelect:a,checkEquality:!1,zIndexMode:s}),p({nodeExtent:e}))},panBy:e=>{let{transform:t,width:n,height:r,panZoom:i,translateExtent:a}=m();return wt({delta:e,panZoom:i,transform:t,translateExtent:a,width:n,height:r})},setCenter:async(e,t,n)=>{let{width:r,height:i,maxZoom:a,panZoom:o}=m();if(!o)return Promise.resolve(!1);let s=n?.zoom===void 0?a:n.zoom;return await o.setViewport({x:r/2-e*s,y:i/2-t*s,zoom:s},{duration:n?.duration,ease:n?.ease,interpolate:n?.interpolate}),Promise.resolve(!0)},cancelConnection:()=>{p({connection:{...P}})},updateConnection:e=>{p({connection:e})},reset:()=>p({...ya()})}},Object.is);function xa({initialNodes:e,initialEdges:t,defaultNodes:n,defaultEdges:r,initialWidth:i,initialHeight:a,initialMinZoom:o,initialMaxZoom:s,initialFitViewOptions:c,fitView:l,nodeOrigin:u,nodeExtent:d,zIndexMode:f,children:p}){let[m]=(0,E.useState)(()=>ba({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:i,height:a,fitView:l,minZoom:o,maxZoom:s,fitViewOptions:c,nodeOrigin:u,nodeExtent:d,zIndexMode:f}));return(0,T.jsx)(On,{value:m,children:(0,T.jsx)(xr,{children:p})})}function Sa({children:e,nodes:t,edges:n,defaultNodes:r,defaultEdges:i,width:a,height:o,fitView:s,fitViewOptions:c,minZoom:l,maxZoom:u,nodeOrigin:d,nodeExtent:f,zIndexMode:p}){return(0,E.useContext)(Dn)?(0,T.jsx)(T.Fragment,{children:e}):(0,T.jsx)(xa,{initialNodes:t,initialEdges:n,defaultNodes:r,defaultEdges:i,initialWidth:a,initialHeight:o,fitView:s,initialFitViewOptions:c,initialMinZoom:l,initialMaxZoom:u,nodeOrigin:d,nodeExtent:f,zIndexMode:p,children:e})}var Ca={width:`100%`,height:`100%`,overflow:`hidden`,position:`relative`,zIndex:0};function wa({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,className:i,nodeTypes:a,edgeTypes:o,onNodeClick:s,onEdgeClick:l,onInit:u,onMove:d,onMoveStart:f,onMoveEnd:p,onConnect:m,onConnectStart:h,onConnectEnd:g,onClickConnectStart:_,onClickConnectEnd:v,onNodeMouseEnter:y,onNodeMouseMove:b,onNodeMouseLeave:x,onNodeContextMenu:S,onNodeDoubleClick:C,onNodeDragStart:w,onNodeDrag:D,onNodeDragStop:k,onNodesDelete:A,onEdgesDelete:j,onDelete:P,onSelectionChange:I,onSelectionDragStart:L,onSelectionDrag:R,onSelectionDragStop:z,onSelectionContextMenu:B,onSelectionStart:V,onSelectionEnd:H,onBeforeDelete:U,connectionMode:W,connectionLineType:G=F.Bezier,connectionLineStyle:K,connectionLineComponent:q,connectionLineContainerStyle:ee,deleteKeyCode:te=`Backspace`,selectionKeyCode:ne=`Shift`,selectionOnDrag:re=!1,selectionMode:ie=N.Full,panActivationKeyCode:ae=`Space`,multiSelectionKeyCode:oe=we()?`Meta`:`Control`,zoomActivationKeyCode:se=we()?`Meta`:`Control`,snapToGrid:ce,snapGrid:le,onlyRenderVisibleElements:ue=!1,selectNodesOnDrag:de,nodesDraggable:J,autoPanOnNodeFocus:fe,nodesConnectable:pe,nodesFocusable:me,nodeOrigin:he=qn,edgesFocusable:Y,edgesReconnectable:ge,elementsSelectable:_e=!0,defaultViewport:ve=Jn,minZoom:ye=.5,maxZoom:be=2,translateExtent:xe=O,preventScrolling:Se=!0,nodeExtent:Ce,defaultMarkerColor:Te=`#b1b1b7`,zoomOnScroll:Ee=!0,zoomOnPinch:De=!0,panOnScroll:Oe=!1,panOnScrollSpeed:ke=.5,panOnScrollMode:Ae=M.Free,zoomOnDoubleClick:je=!0,panOnDrag:Me=!0,onPaneClick:Ne,onPaneMouseEnter:Pe,onPaneMouseMove:Fe,onPaneMouseLeave:Ie,onPaneScroll:Le,onPaneContextMenu:X,paneClickDistance:Re=1,nodeClickDistance:ze=0,children:Be,onReconnect:Ve,onReconnectStart:He,onReconnectEnd:Ue,onEdgeContextMenu:We,onEdgeDoubleClick:Ge,onEdgeMouseEnter:Ke,onEdgeMouseMove:qe,onEdgeMouseLeave:Je,reconnectRadius:Ye=10,onNodesChange:Xe,onEdgesChange:Ze,noDragClassName:Qe=`nodrag`,noWheelClassName:$e=`nowheel`,noPanClassName:et=`nopan`,fitView:tt,fitViewOptions:nt,connectOnClick:rt,attributionPosition:it,proOptions:at,defaultEdgeOptions:ot,elevateNodesOnSelect:st=!0,elevateEdgesOnSelect:ct=!1,disableKeyboardA11y:lt=!1,autoPanOnConnect:ut,autoPanOnNodeDrag:dt,autoPanSpeed:ft,connectionRadius:pt,isValidConnection:mt,onError:ht,style:gt,id:_t,nodeDragThreshold:vt,connectionDragThreshold:yt,viewport:bt,onViewportChange:xt,width:St,height:Ct,colorMode:wt=`light`,debug:Tt,onScroll:Et,ariaLabelConfig:Dt,zIndexMode:Ot=`basic`,...kt},At){let jt=_t||`1`,Mt=er(wt),Nt=(0,E.useCallback)(e=>{e.currentTarget.scrollTo({top:0,left:0,behavior:`instant`}),Et?.(e)},[Et]);return(0,T.jsx)(`div`,{"data-testid":`rf__wrapper`,...kt,onScroll:Nt,style:{...gt,...Ca},ref:At,className:c([`react-flow`,i,Mt]),id:_t,role:`application`,children:(0,T.jsxs)(Sa,{nodes:e,edges:t,width:St,height:Ct,fitView:tt,fitViewOptions:nt,minZoom:ye,maxZoom:be,nodeOrigin:he,nodeExtent:Ce,zIndexMode:Ot,children:[(0,T.jsx)(va,{onInit:u,onNodeClick:s,onEdgeClick:l,onNodeMouseEnter:y,onNodeMouseMove:b,onNodeMouseLeave:x,onNodeContextMenu:S,onNodeDoubleClick:C,nodeTypes:a,edgeTypes:o,connectionLineType:G,connectionLineStyle:K,connectionLineComponent:q,connectionLineContainerStyle:ee,selectionKeyCode:ne,selectionOnDrag:re,selectionMode:ie,deleteKeyCode:te,multiSelectionKeyCode:oe,panActivationKeyCode:ae,zoomActivationKeyCode:se,onlyRenderVisibleElements:ue,defaultViewport:ve,translateExtent:xe,minZoom:ye,maxZoom:be,preventScrolling:Se,zoomOnScroll:Ee,zoomOnPinch:De,zoomOnDoubleClick:je,panOnScroll:Oe,panOnScrollSpeed:ke,panOnScrollMode:Ae,panOnDrag:Me,onPaneClick:Ne,onPaneMouseEnter:Pe,onPaneMouseMove:Fe,onPaneMouseLeave:Ie,onPaneScroll:Le,onPaneContextMenu:X,paneClickDistance:Re,nodeClickDistance:ze,onSelectionContextMenu:B,onSelectionStart:V,onSelectionEnd:H,onReconnect:Ve,onReconnectStart:He,onReconnectEnd:Ue,onEdgeContextMenu:We,onEdgeDoubleClick:Ge,onEdgeMouseEnter:Ke,onEdgeMouseMove:qe,onEdgeMouseLeave:Je,reconnectRadius:Ye,defaultMarkerColor:Te,noDragClassName:Qe,noWheelClassName:$e,noPanClassName:et,rfId:jt,disableKeyboardA11y:lt,nodeExtent:Ce,viewport:bt,onViewportChange:xt}),(0,T.jsx)(Qn,{nodes:e,edges:t,defaultNodes:n,defaultEdges:r,onConnect:m,onConnectStart:h,onConnectEnd:g,onClickConnectStart:_,onClickConnectEnd:v,nodesDraggable:J,autoPanOnNodeFocus:fe,nodesConnectable:pe,nodesFocusable:me,edgesFocusable:Y,edgesReconnectable:ge,elementsSelectable:_e,elevateNodesOnSelect:st,elevateEdgesOnSelect:ct,minZoom:ye,maxZoom:be,nodeExtent:Ce,onNodesChange:Xe,onEdgesChange:Ze,snapToGrid:ce,snapGrid:le,connectionMode:W,translateExtent:xe,connectOnClick:rt,defaultEdgeOptions:ot,fitView:tt,fitViewOptions:nt,onNodesDelete:A,onEdgesDelete:j,onDelete:P,onNodeDragStart:w,onNodeDrag:D,onNodeDragStop:k,onSelectionDrag:R,onSelectionDragStart:L,onSelectionDragStop:z,onMove:d,onMoveStart:f,onMoveEnd:p,noPanClassName:et,nodeOrigin:he,rfId:jt,autoPanOnConnect:ut,autoPanOnNodeDrag:dt,autoPanSpeed:ft,onError:ht,connectionRadius:pt,isValidConnection:mt,selectNodesOnDrag:de,nodeDragThreshold:vt,connectionDragThreshold:yt,onBeforeDelete:U,debug:Tt,ariaLabelConfig:Dt,zIndexMode:Ot}),(0,T.jsx)(Kn,{onSelectionChange:I}),Be,(0,T.jsx)(Bn,{proOptions:at,position:it}),(0,T.jsx)(Rn,{rfId:jt,disableKeyboardA11y:lt})]})})}var Ta=gr(wa);D.error014();function Ea({dimensions:e,lineWidth:t,variant:n,className:r}){return(0,T.jsx)(`path`,{strokeWidth:t,d:`M${e[0]/2} 0 V${e[1]} M0 ${e[1]/2} H${e[0]}`,className:c([`react-flow__background-pattern`,n,r])})}function Da({radius:e,className:t}){return(0,T.jsx)(`circle`,{cx:e,cy:e,r:e,className:c([`react-flow__background-pattern`,`dots`,t])})}var Oa;(function(e){e.Lines=`lines`,e.Dots=`dots`,e.Cross=`cross`})(Oa||={});var ka={[Oa.Dots]:1,[Oa.Lines]:1,[Oa.Cross]:6},Aa=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function ja({id:e,variant:t=Oa.Dots,gap:n=20,size:r,lineWidth:i=1,offset:a=0,color:o,bgColor:s,style:l,className:u,patternClassName:d}){let f=(0,E.useRef)(null),{transform:p,patternId:m}=Q(Aa,Z),h=r||ka[t],g=t===Oa.Dots,_=t===Oa.Cross,v=Array.isArray(n)?n:[n,n],y=[v[0]*p[2]||1,v[1]*p[2]||1],b=h*p[2],x=Array.isArray(a)?a:[a,a],S=_?[b,b]:y,C=[x[0]*p[2]||1+S[0]/2,x[1]*p[2]||1+S[1]/2],w=`${m}${e||``}`;return(0,T.jsxs)(`svg`,{className:c([`react-flow__background`,u]),style:{...l,...kr,"--xy-background-color-props":s,"--xy-background-pattern-color-props":o},ref:f,"data-testid":`rf__background`,children:[(0,T.jsx)(`pattern`,{id:w,x:p[0]%y[0],y:p[1]%y[1],width:y[0],height:y[1],patternUnits:`userSpaceOnUse`,patternTransform:`translate(-${C[0]},-${C[1]})`,children:g?(0,T.jsx)(Da,{radius:b/2,className:d}):(0,T.jsx)(Ea,{dimensions:S,lineWidth:i,variant:t,className:d})}),(0,T.jsx)(`rect`,{x:`0`,y:`0`,width:`100%`,height:`100%`,fill:`url(#${w})`})]})}ja.displayName=`Background`;var Ma=(0,E.memo)(ja);function Na(){return(0,T.jsx)(`svg`,{xmlns:`http://www.w3.org/2000/svg`,viewBox:`0 0 32 32`,children:(0,T.jsx)(`path`,{d:`M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z`})})}function Pa(){return(0,T.jsx)(`svg`,{xmlns:`http://www.w3.org/2000/svg`,viewBox:`0 0 32 5`,children:(0,T.jsx)(`path`,{d:`M0 0h32v4.2H0z`})})}function Fa(){return(0,T.jsx)(`svg`,{xmlns:`http://www.w3.org/2000/svg`,viewBox:`0 0 32 30`,children:(0,T.jsx)(`path`,{d:`M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z`})})}function Ia(){return(0,T.jsx)(`svg`,{xmlns:`http://www.w3.org/2000/svg`,viewBox:`0 0 25 32`,children:(0,T.jsx)(`path`,{d:`M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z`})})}function La(){return(0,T.jsx)(`svg`,{xmlns:`http://www.w3.org/2000/svg`,viewBox:`0 0 25 32`,children:(0,T.jsx)(`path`,{d:`M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z`})})}function Ra({children:e,className:t,...n}){return(0,T.jsx)(`button`,{type:`button`,className:c([`react-flow__controls-button`,t]),...n,children:e})}var za=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom,ariaLabelConfig:e.ariaLabelConfig});function Ba({style:e,showZoom:t=!0,showFitView:n=!0,showInteractive:r=!0,fitViewOptions:i,onZoomIn:a,onZoomOut:o,onFitView:s,onInteractiveChange:l,className:u,children:d,position:f=`bottom-left`,orientation:p=`vertical`,"aria-label":m}){let h=$(),{isInteractive:g,minZoomReached:_,maxZoomReached:v,ariaLabelConfig:y}=Q(za,Z),{zoomIn:b,zoomOut:x,fitView:S}=wr(),C=()=>{b(),a?.()},w=()=>{x(),o?.()},E=()=>{S(i),s?.()},D=()=>{h.setState({nodesDraggable:!g,nodesConnectable:!g,elementsSelectable:!g}),l?.(!g)};return(0,T.jsxs)(zn,{className:c([`react-flow__controls`,p===`horizontal`?`horizontal`:`vertical`,u]),position:f,style:e,"data-testid":`rf__controls`,"aria-label":m??y[`controls.ariaLabel`],children:[t&&(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(Ra,{onClick:C,className:`react-flow__controls-zoomin`,title:y[`controls.zoomIn.ariaLabel`],"aria-label":y[`controls.zoomIn.ariaLabel`],disabled:v,children:(0,T.jsx)(Na,{})}),(0,T.jsx)(Ra,{onClick:w,className:`react-flow__controls-zoomout`,title:y[`controls.zoomOut.ariaLabel`],"aria-label":y[`controls.zoomOut.ariaLabel`],disabled:_,children:(0,T.jsx)(Pa,{})})]}),n&&(0,T.jsx)(Ra,{className:`react-flow__controls-fitview`,onClick:E,title:y[`controls.fitView.ariaLabel`],"aria-label":y[`controls.fitView.ariaLabel`],children:(0,T.jsx)(Fa,{})}),r&&(0,T.jsx)(Ra,{className:`react-flow__controls-interactive`,onClick:D,title:y[`controls.interactive.ariaLabel`],"aria-label":y[`controls.interactive.ariaLabel`],children:g?(0,T.jsx)(La,{}):(0,T.jsx)(Ia,{})}),d]})}Ba.displayName=`Controls`,(0,E.memo)(Ba);function Va({id:e,x:t,y:n,width:r,height:i,style:a,color:o,strokeColor:s,strokeWidth:l,className:u,borderRadius:d,shapeRendering:f,selected:p,onClick:m}){let{background:h,backgroundColor:g}=a||{},_=o||h||g;return(0,T.jsx)(`rect`,{className:c([`react-flow__minimap-node`,{selected:p},u]),x:t,y:n,rx:d,ry:d,width:r,height:i,style:{fill:_,stroke:s,strokeWidth:l},shapeRendering:f,onClick:m?t=>m(t,e):void 0})}var Ha=(0,E.memo)(Va),Ua=e=>e.nodes.map(e=>e.id),Wa=e=>e instanceof Function?e:()=>e;function Ga({nodeStrokeColor:e,nodeColor:t,nodeClassName:n=``,nodeBorderRadius:r=5,nodeStrokeWidth:i,nodeComponent:a=Ha,onClick:o}){let s=Q(Ua,Z),c=Wa(t),l=Wa(e),u=Wa(n),d=typeof window>`u`||window.chrome?`crispEdges`:`geometricPrecision`;return(0,T.jsx)(T.Fragment,{children:s.map(e=>(0,T.jsx)(qa,{id:e,nodeColorFunc:c,nodeStrokeColorFunc:l,nodeClassNameFunc:u,nodeBorderRadius:r,nodeStrokeWidth:i,NodeComponent:a,onClick:o,shapeRendering:d},e))})}function Ka({id:e,nodeColorFunc:t,nodeStrokeColorFunc:n,nodeClassNameFunc:r,nodeBorderRadius:i,nodeStrokeWidth:a,shapeRendering:o,NodeComponent:s,onClick:c}){let{node:l,x:u,y:d,width:f,height:p}=Q(t=>{let{internals:n}=t.nodeLookup.get(e),r=n.userNode,{x:i,y:a}=n.positionAbsolute,{width:o,height:s}=Ee(r);return{node:r,x:i,y:a,width:o,height:s}},Z);return!l||l.hidden||!De(l)?null:(0,T.jsx)(s,{x:u,y:d,width:f,height:p,style:l.style,selected:!!l.selected,className:r(l),color:t(l),borderRadius:i,strokeColor:n(l),strokeWidth:a,shapeRendering:o,onClick:c,id:l.id})}var qa=(0,E.memo)(Ka),Ja=(0,E.memo)(Ga),Ya=200,Xa=150,Za=e=>!e.hidden,Qa=e=>{let t={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:t,boundingRect:e.nodeLookup.size>0?pe(G(e.nodeLookup,{filter:Za}),t):t,rfId:e.rfId,panZoom:e.panZoom,translateExtent:e.translateExtent,flowWidth:e.width,flowHeight:e.height,ariaLabelConfig:e.ariaLabelConfig}},$a=`react-flow__minimap-desc`;function eo({style:e,className:t,nodeStrokeColor:n,nodeColor:r,nodeClassName:i=``,nodeBorderRadius:a=5,nodeStrokeWidth:o,nodeComponent:s,bgColor:l,maskColor:u,maskStrokeColor:d,maskStrokeWidth:f,position:p=`bottom-right`,onClick:m,onNodeClick:h,pannable:g=!1,zoomable:_=!1,ariaLabel:v,inversePan:y,zoomStep:b=1,offsetScale:x=5}){let S=$(),C=(0,E.useRef)(null),{boundingRect:w,viewBB:D,rfId:O,panZoom:k,translateExtent:A,flowWidth:j,flowHeight:M,ariaLabelConfig:N}=Q(Qa,Z),P=e?.width??Ya,F=e?.height??Xa,I=w.width/P,L=w.height/F,R=Math.max(I,L),z=R*P,B=R*F,V=x*R,H=w.x-(z-w.width)/2-V,U=w.y-(B-w.height)/2-V,W=z+V*2,G=B+V*2,K=`${$a}-${O}`,q=(0,E.useRef)(0),ee=(0,E.useRef)();q.current=R,(0,E.useEffect)(()=>{if(C.current&&k)return ee.current=Ut({domNode:C.current,panZoom:k,getTransform:()=>S.getState().transform,getViewScale:()=>q.current}),()=>{ee.current?.destroy()}},[k]),(0,E.useEffect)(()=>{ee.current?.update({translateExtent:A,width:j,height:M,inversePan:y,pannable:g,zoomStep:b,zoomable:_})},[g,_,y,b,A,j,M]);let te=m?e=>{let[t,n]=ee.current?.pointer(e)||[0,0];m(e,{x:t,y:n})}:void 0,ne=h?(0,E.useCallback)((e,t)=>{let n=S.getState().nodeLookup.get(t).internals.userNode;h(e,n)},[]):void 0,re=v??N[`minimap.ariaLabel`];return(0,T.jsx)(zn,{position:p,style:{...e,"--xy-minimap-background-color-props":typeof l==`string`?l:void 0,"--xy-minimap-mask-background-color-props":typeof u==`string`?u:void 0,"--xy-minimap-mask-stroke-color-props":typeof d==`string`?d:void 0,"--xy-minimap-mask-stroke-width-props":typeof f==`number`?f*R:void 0,"--xy-minimap-node-background-color-props":typeof r==`string`?r:void 0,"--xy-minimap-node-stroke-color-props":typeof n==`string`?n:void 0,"--xy-minimap-node-stroke-width-props":typeof o==`number`?o:void 0},className:c([`react-flow__minimap`,t]),"data-testid":`rf__minimap`,children:(0,T.jsxs)(`svg`,{width:P,height:F,viewBox:`${H} ${U} ${W} ${G}`,className:`react-flow__minimap-svg`,role:`img`,"aria-labelledby":K,ref:C,onClick:te,children:[re&&(0,T.jsx)(`title`,{id:K,children:re}),(0,T.jsx)(Ja,{onClick:ne,nodeColor:r,nodeStrokeColor:n,nodeBorderRadius:a,nodeClassName:i,nodeStrokeWidth:o,nodeComponent:s}),(0,T.jsx)(`path`,{className:`react-flow__minimap-mask`,d:`M${H-V},${U-V}h${W+V*2}v${G+V*2}h${-W-V*2}z
        M${D.x},${D.y}h${D.width}v${D.height}h${-D.width}z`,fillRule:`evenodd`,pointerEvents:`none`})]})})}eo.displayName=`MiniMap`,(0,E.memo)(eo);var to=e=>t=>e?`${Math.max(1/t.transform[2],1)}`:void 0,no={[an.Line]:`right`,[an.Handle]:`bottom-right`};function ro({nodeId:e,position:t,variant:n=an.Handle,className:r,style:i=void 0,children:a,color:o,minWidth:s=10,minHeight:l=10,maxWidth:u=Number.MAX_VALUE,maxHeight:d=Number.MAX_VALUE,keepAspectRatio:f=!1,resizeDirection:p,autoScale:m=!0,shouldResize:h,onResizeStart:g,onResize:_,onResizeEnd:v}){let y=Ur(),b=typeof e==`string`?e:y,x=$(),S=(0,E.useRef)(null),C=n===an.Handle,w=Q((0,E.useCallback)(to(C&&m),[C,m]),Z),D=(0,E.useRef)(null),O=t??no[n];return(0,E.useEffect)(()=>{if(!(!S.current||!b))return D.current||=_n({domNode:S.current,nodeId:b,getStoreItems:()=>{let{nodeLookup:e,transform:t,snapGrid:n,snapToGrid:r,nodeOrigin:i,domNode:a}=x.getState();return{nodeLookup:e,transform:t,snapGrid:n,snapToGrid:r,nodeOrigin:i,paneDomNode:a}},onChange:(e,t)=>{let{triggerNodeChanges:n,nodeLookup:r,parentLookup:i,nodeOrigin:a}=x.getState(),o=[],s={x:e.x,y:e.y},c=r.get(b);if(c&&c.expandParent&&c.parentId){let t=c.origin??a,n=e.width??c.measured.width??0,l=e.height??c.measured.height??0,u=St([{id:c.id,parentId:c.parentId,rect:{width:n,height:l,...Oe({x:e.x??c.position.x,y:e.y??c.position.y},{width:n,height:l},c.parentId,r,t)}}],r,i,a);o.push(...u),s.x=e.x?Math.max(t[0]*n,e.x):void 0,s.y=e.y?Math.max(t[1]*l,e.y):void 0}if(s.x!==void 0&&s.y!==void 0){let e={id:b,type:`position`,position:{...s}};o.push(e)}if(e.width!==void 0&&e.height!==void 0){let t={id:b,type:`dimensions`,resizing:!0,setAttributes:p?p===`horizontal`?`width`:`height`:!0,dimensions:{width:e.width,height:e.height}};o.push(t)}for(let e of t){let t={...e,type:`position`};o.push(t)}n(o)},onEnd:({width:e,height:t})=>{let n={id:b,type:`dimensions`,resizing:!1,dimensions:{width:e,height:t}};x.getState().triggerNodeChanges([n])}}),D.current.update({controlPosition:O,boundaries:{minWidth:s,minHeight:l,maxWidth:u,maxHeight:d},keepAspectRatio:f,resizeDirection:p,onResizeStart:g,onResize:_,onResizeEnd:v,shouldResize:h}),()=>{D.current?.destroy()}},[O,s,l,u,d,f,g,_,v,h]),(0,T.jsx)(`div`,{className:c([`react-flow__resize-control`,`nodrag`,...O.split(`-`),n,r]),ref:S,style:{...i,scale:w,...o&&{[C?`backgroundColor`:`borderColor`]:o}},children:a})}(0,E.memo)(ro);function io({data:e}){return(0,T.jsxs)(`div`,{onClick:e.onClick,style:{padding:`10px 16px`,borderRadius:12,fontSize:12,fontWeight:600,minWidth:120,textAlign:`center`,cursor:`pointer`,color:`#000`,background:e.isActive?`#00e676`:e.isLeaf?`#ffd54f`:`#64b5f6`,boxShadow:e.isActive?`0 0 18px rgba(0,230,118,0.9)`:`0 4px 12px rgba(0,0,0,0.4)`,transition:`all 0.3s ease`,userSelect:`none`},children:[e.label,(0,T.jsx)(qr,{type:`target`,position:L.Top}),(0,T.jsx)(qr,{type:`source`,position:L.Bottom})]})}const ao={id:`animalia`,label:`Animalia (K)`,children:[{id:`parazoa`,label:`Parazoa (SK)`,children:[{id:`porifera`,label:`Porifera (P)`}]},{id:`eumetazoa`,label:`Eumetazoa (SK)`,children:[{id:`radial`,label:`Radial`,children:[{id:`coelenterata`,label:`Coelenterata (P)`},{id:`ctenophora`,label:`Ctenophora (P)`}]},{id:`bilateral`,label:`Bilateral`,children:[{id:`acoelomates`,label:`Acoelomates`,children:[{id:`platyhelminthes`,label:`Platyhelminthes (P)`}]},{id:`pseudocoelomates`,label:`Pseudocoelomates`,children:[{id:`aschelminthes`,label:`Aschelminthes (P)`}]},{id:`coelomates`,label:`Coelomates`,children:[{id:`annelida`,label:`Annelida (P)`},{id:`arthropoda`,label:`Arthropoda (P)`},{id:`mollusca`,label:`Mollusca (P)`},{id:`echinodermata`,label:`Echinodermata (P)`},{id:`hemichordata`,label:`Hemichordata (P)`},{id:`chordata`,label:`Chordata (P)`}]}]}]}]};var oo={custom:io};function so(){let e=g(),{fitView:t}=wr(),[n,r]=(0,E.useState)({}),[i,a]=(0,E.useState)(null),o=[],s=[],c=window.innerWidth<768?160:240,l=(t,n)=>{if(a(n.id),!n.children||n.children.length===0){e(`/animal/${n.id}`);return}r(e=>({...e,[t]:e[t]===n.id?``:n.id}))},u=(e,t,r,a)=>{let d=!e.children||e.children.length===0;if(o.push({id:e.id,type:`custom`,position:{x:t,y:r},data:{label:e.label,isLeaf:d,isActive:i===e.id,onClick:()=>l(a??`root`,e)}}),a&&s.push({id:`${a}-${e.id}`,source:a,target:e.id,animated:!0}),!e.children)return;let f=n[a??`root`];a&&f!==e.id||e.children.forEach((n,i)=>{u(n,t+(i-(e.children.length-1)/2)*c,r+120,e.id)})};u(ao,0,0);let d=(0,E.useCallback)(()=>{t({duration:800,padding:.2})},[t]),f=(0,E.useCallback)(()=>{r({}),a(null),setTimeout(()=>{t({duration:800,padding:.2})},100)},[t]);return(0,T.jsx)(`div`,{style:{height:`100vh`,background:`#121212`},children:(0,T.jsxs)(Ta,{nodes:o,edges:s,nodeTypes:oo,fitView:!0,minZoom:.3,proOptions:{hideAttribution:!0},children:[(0,T.jsx)(Ma,{}),(0,T.jsxs)(zn,{position:`top-right`,style:{marginTop:`90px`,marginRight:`30px`,display:`flex`,gap:`12px`,padding:`8px`,background:`rgba(30, 41, 59, 0.7)`,backdropFilter:`blur(10px)`,borderRadius:`12px`,border:`1px solid rgba(255, 255, 255, 0.1)`,boxShadow:`0 8px 32px rgba(0, 0, 0, 0.3)`},children:[(0,T.jsxs)(`button`,{onClick:f,title:`Collapse all nodes`,style:{background:`linear-gradient(135deg, #2f7d46, #1e5231)`,color:`white`,border:`1px solid rgba(255, 255, 255, 0.1)`,padding:`10px 16px`,borderRadius:`8px`,cursor:`pointer`,fontWeight:`600`,fontSize:`13px`,display:`flex`,alignItems:`center`,gap:`8px`,transition:`all 0.2s ease`,boxShadow:`0 2px 4px rgba(0, 0, 0, 0.2)`},onMouseOver:e=>{e.currentTarget.style.transform=`translateY(-1px)`,e.currentTarget.style.boxShadow=`0 4px 8px rgba(47, 125, 70, 0.4)`},onMouseOut:e=>{e.currentTarget.style.transform=`translateY(0)`,e.currentTarget.style.boxShadow=`0 2px 4px rgba(0, 0, 0, 0.2)`},children:[(0,T.jsx)(`span`,{style:{fontSize:`16px`},children:``}),` Reset Tree`]}),(0,T.jsx)(`div`,{style:{width:`1px`,background:`rgba(255,255,255,0.1)`,margin:`0 4px`}}),(0,T.jsxs)(`button`,{onClick:d,title:`Center view`,style:{background:`rgba(255, 255, 255, 0.1)`,color:`#e2e8f0`,border:`1px solid rgba(255, 255, 255, 0.05)`,padding:`10px 16px`,borderRadius:`8px`,cursor:`pointer`,fontWeight:`600`,fontSize:`13px`,display:`flex`,alignItems:`center`,gap:`8px`,transition:`all 0.2s ease`},onMouseOver:e=>{e.currentTarget.style.background=`rgba(255, 255, 255, 0.2)`,e.currentTarget.style.color=`white`},onMouseOut:e=>{e.currentTarget.style.background=`rgba(255, 255, 255, 0.1)`,e.currentTarget.style.color=`#e2e8f0`},children:[(0,T.jsx)(`span`,{style:{fontSize:`16px`},children:``}),` Reset View`]})]})]})})}function co(){return(0,T.jsx)(xa,{children:(0,T.jsx)(so,{})})}function lo(){return(0,T.jsx)(T.Fragment,{children:(0,T.jsx)(co,{})})}var uo=lo;export{uo as default};